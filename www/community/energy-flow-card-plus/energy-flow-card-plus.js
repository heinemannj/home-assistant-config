function t(t,e,i,o){var n,r=arguments.length,l=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(r<3?n(l):r>3?n(e,i,l):n(e,i))||l);return r>3&&l&&Object.defineProperty(e,i,l),l}const e=window,i=e.ShadowRoot&&(void 0===e.ShadyCSS||e.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,o=Symbol(),n=new WeakMap;class r{constructor(t,e,i){if(this._$cssResult$=!0,i!==o)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(i&&void 0===t){const i=void 0!==e&&1===e.length;i&&(t=n.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&n.set(e,t))}return t}toString(){return this.cssText}}const l=(t,...e)=>{const i=1===t.length?t[0]:e.reduce(((e,i,o)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[o+1]),t[0]);return new r(i,t,o)},a=i?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const i of t.cssRules)e+=i.cssText;return(t=>new r("string"==typeof t?t:t+"",void 0,o))(e)})(t):t;var s;const d=window,c=d.trustedTypes,u=c?c.emptyScript:"",v=d.reactiveElementPolyfillSupport,h={toAttribute(t,e){switch(e){case Boolean:t=t?u:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},p=(t,e)=>e!==t&&(e==e||t==t),y={attribute:!0,type:String,converter:h,reflect:!1,hasChanged:p};class g extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var e;this.finalize(),(null!==(e=this.h)&&void 0!==e?e:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((e,i)=>{const o=this._$Ep(i,e);void 0!==o&&(this._$Ev.set(o,i),t.push(o))})),t}static createProperty(t,e=y){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const i="symbol"==typeof t?Symbol():"__"+t,o=this.getPropertyDescriptor(t,i,e);void 0!==o&&Object.defineProperty(this.prototype,t,o)}}static getPropertyDescriptor(t,e,i){return{get(){return this[e]},set(o){const n=this[t];this[e]=o,this.requestUpdate(t,n,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||y}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const i of e)this.createProperty(i,t[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)e.unshift(a(t))}else void 0!==t&&e.push(a(t));return e}static _$Ep(t,e){const i=e.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof t?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,i;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(i=t.hostConnected)||void 0===i||i.call(t))}removeController(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Ei.set(e,this[e]),delete this[e])}))}createRenderRoot(){var t;const o=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,o)=>{i?t.adoptedStyleSheets=o.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):o.forEach((i=>{const o=document.createElement("style"),n=e.litNonce;void 0!==n&&o.setAttribute("nonce",n),o.textContent=i.cssText,t.appendChild(o)}))})(o,this.constructor.elementStyles),o}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$EO(t,e,i=y){var o;const n=this.constructor._$Ep(t,i);if(void 0!==n&&!0===i.reflect){const r=(void 0!==(null===(o=i.converter)||void 0===o?void 0:o.toAttribute)?i.converter:h).toAttribute(e,i.type);this._$El=t,null==r?this.removeAttribute(n):this.setAttribute(n,r),this._$El=null}}_$AK(t,e){var i;const o=this.constructor,n=o._$Ev.get(t);if(void 0!==n&&this._$El!==n){const t=o.getPropertyOptions(n),r="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==(null===(i=t.converter)||void 0===i?void 0:i.fromAttribute)?t.converter:h;this._$El=n,this[n]=r.fromAttribute(e,t.type),this._$El=null}}requestUpdate(t,e,i){let o=!0;void 0!==t&&(((i=i||this.constructor.getPropertyOptions(t)).hasChanged||p)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===i.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,i))):o=!1),!this.isUpdatePending&&o&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((t,e)=>this[e]=t)),this._$Ei=void 0);let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(i)):this._$Ek()}catch(t){throw e=!1,this._$Ek(),t}e&&this._$AE(i)}willUpdate(t){}_$AE(t){var e;null===(e=this._$ES)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach(((t,e)=>this._$EO(e,this[e],t))),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}var m;g.finalized=!0,g.elementProperties=new Map,g.elementStyles=[],g.shadowRootOptions={mode:"open"},null==v||v({ReactiveElement:g}),(null!==(s=d.reactiveElementVersions)&&void 0!==s?s:d.reactiveElementVersions=[]).push("1.6.1");const _=window,f=_.trustedTypes,b=f?f.createPolicy("lit-html",{createHTML:t=>t}):void 0,$="$lit$",w=`lit$${(Math.random()+"").slice(9)}$`,x="?"+w,k=`<${x}>`,E=document,S=()=>E.createComment(""),A=t=>null===t||"object"!=typeof t&&"function"!=typeof t,M=Array.isArray,C="[ \t\n\f\r]",P=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,D=/-->/g,O=/>/g,j=RegExp(`>|${C}(?:([^\\s"'>=/]+)(${C}*=${C}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),N=/'/g,z=/"/g,T=/^(?:script|style|textarea|title)$/i,R=t=>(e,...i)=>({_$litType$:t,strings:e,values:i}),H=R(1),U=R(2),I=Symbol.for("lit-noChange"),W=Symbol.for("lit-nothing"),F=new WeakMap,L=E.createTreeWalker(E,129,null,!1),V=(t,e)=>{const i=t.length-1,o=[];let n,r=2===e?"<svg>":"",l=P;for(let e=0;e<i;e++){const i=t[e];let a,s,d=-1,c=0;for(;c<i.length&&(l.lastIndex=c,s=l.exec(i),null!==s);)c=l.lastIndex,l===P?"!--"===s[1]?l=D:void 0!==s[1]?l=O:void 0!==s[2]?(T.test(s[2])&&(n=RegExp("</"+s[2],"g")),l=j):void 0!==s[3]&&(l=j):l===j?">"===s[0]?(l=null!=n?n:P,d=-1):void 0===s[1]?d=-2:(d=l.lastIndex-s[2].length,a=s[1],l=void 0===s[3]?j:'"'===s[3]?z:N):l===z||l===N?l=j:l===D||l===O?l=P:(l=j,n=void 0);const u=l===j&&t[e+1].startsWith("/>")?" ":"";r+=l===P?i+k:d>=0?(o.push(a),i.slice(0,d)+$+i.slice(d)+w+u):i+w+(-2===d?(o.push(void 0),e):u)}const a=r+(t[i]||"<?>")+(2===e?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==b?b.createHTML(a):a,o]};class B{constructor({strings:t,_$litType$:e},i){let o;this.parts=[];let n=0,r=0;const l=t.length-1,a=this.parts,[s,d]=V(t,e);if(this.el=B.createElement(s,i),L.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(o=L.nextNode())&&a.length<l;){if(1===o.nodeType){if(o.hasAttributes()){const t=[];for(const e of o.getAttributeNames())if(e.endsWith($)||e.startsWith(w)){const i=d[r++];if(t.push(e),void 0!==i){const t=o.getAttribute(i.toLowerCase()+$).split(w),e=/([.?@])?(.*)/.exec(i);a.push({type:1,index:n,name:e[2],strings:t,ctor:"."===e[1]?q:"?"===e[1]?Q:"@"===e[1]?X:K})}else a.push({type:6,index:n})}for(const e of t)o.removeAttribute(e)}if(T.test(o.tagName)){const t=o.textContent.split(w),e=t.length-1;if(e>0){o.textContent=f?f.emptyScript:"";for(let i=0;i<e;i++)o.append(t[i],S()),L.nextNode(),a.push({type:2,index:++n});o.append(t[e],S())}}}else if(8===o.nodeType)if(o.data===x)a.push({type:2,index:n});else{let t=-1;for(;-1!==(t=o.data.indexOf(w,t+1));)a.push({type:7,index:n}),t+=w.length-1}n++}}static createElement(t,e){const i=E.createElement("template");return i.innerHTML=t,i}}function Z(t,e,i=t,o){var n,r,l,a;if(e===I)return e;let s=void 0!==o?null===(n=i._$Co)||void 0===n?void 0:n[o]:i._$Cl;const d=A(e)?void 0:e._$litDirective$;return(null==s?void 0:s.constructor)!==d&&(null===(r=null==s?void 0:s._$AO)||void 0===r||r.call(s,!1),void 0===d?s=void 0:(s=new d(t),s._$AT(t,i,o)),void 0!==o?(null!==(l=(a=i)._$Co)&&void 0!==l?l:a._$Co=[])[o]=s:i._$Cl=s),void 0!==s&&(e=Z(t,s._$AS(t,e.values),s,o)),e}class G{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var e;const{el:{content:i},parts:o}=this._$AD,n=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:E).importNode(i,!0);L.currentNode=n;let r=L.nextNode(),l=0,a=0,s=o[0];for(;void 0!==s;){if(l===s.index){let e;2===s.type?e=new Y(r,r.nextSibling,this,t):1===s.type?e=new s.ctor(r,s.name,s.strings,this,t):6===s.type&&(e=new tt(r,this,t)),this._$AV.push(e),s=o[++a]}l!==(null==s?void 0:s.index)&&(r=L.nextNode(),l++)}return n}v(t){let e=0;for(const i of this._$AV)void 0!==i&&(void 0!==i.strings?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class Y{constructor(t,e,i,o){var n;this.type=2,this._$AH=W,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=o,this._$Cp=null===(n=null==o?void 0:o.isConnected)||void 0===n||n}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cp}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===(null==t?void 0:t.nodeType)&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=Z(this,t,e),A(t)?t===W||null==t||""===t?(this._$AH!==W&&this._$AR(),this._$AH=W):t!==this._$AH&&t!==I&&this._(t):void 0!==t._$litType$?this.g(t):void 0!==t.nodeType?this.$(t):(t=>M(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator]))(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==W&&A(this._$AH)?this._$AA.nextSibling.data=t:this.$(E.createTextNode(t)),this._$AH=t}g(t){var e;const{values:i,_$litType$:o}=t,n="number"==typeof o?this._$AC(t):(void 0===o.el&&(o.el=B.createElement(o.h,this.options)),o);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===n)this._$AH.v(i);else{const t=new G(n,this),e=t.u(this.options);t.v(i),this.$(e),this._$AH=t}}_$AC(t){let e=F.get(t.strings);return void 0===e&&F.set(t.strings,e=new B(t)),e}T(t){M(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,o=0;for(const n of t)o===e.length?e.push(i=new Y(this.k(S()),this.k(S()),this,this.options)):i=e[o],i._$AI(n),o++;o<e.length&&(this._$AR(i&&i._$AB.nextSibling,o),e.length=o)}_$AR(t=this._$AA.nextSibling,e){var i;for(null===(i=this._$AP)||void 0===i||i.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$Cp=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class K{constructor(t,e,i,o,n){this.type=1,this._$AH=W,this._$AN=void 0,this.element=t,this.name=e,this._$AM=o,this.options=n,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=W}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,i,o){const n=this.strings;let r=!1;if(void 0===n)t=Z(this,t,e,0),r=!A(t)||t!==this._$AH&&t!==I,r&&(this._$AH=t);else{const o=t;let l,a;for(t=n[0],l=0;l<n.length-1;l++)a=Z(this,o[i+l],e,l),a===I&&(a=this._$AH[l]),r||(r=!A(a)||a!==this._$AH[l]),a===W?t=W:t!==W&&(t+=(null!=a?a:"")+n[l+1]),this._$AH[l]=a}r&&!o&&this.j(t)}j(t){t===W?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class q extends K{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===W?void 0:t}}const J=f?f.emptyScript:"";class Q extends K{constructor(){super(...arguments),this.type=4}j(t){t&&t!==W?this.element.setAttribute(this.name,J):this.element.removeAttribute(this.name)}}class X extends K{constructor(t,e,i,o,n){super(t,e,i,o,n),this.type=5}_$AI(t,e=this){var i;if((t=null!==(i=Z(this,t,e,0))&&void 0!==i?i:W)===I)return;const o=this._$AH,n=t===W&&o!==W||t.capture!==o.capture||t.once!==o.once||t.passive!==o.passive,r=t!==W&&(o===W||n);n&&this.element.removeEventListener(this.name,this,o),r&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,i;"function"==typeof this._$AH?this._$AH.call(null!==(i=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==i?i:this.element,t):this._$AH.handleEvent(t)}}class tt{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){Z(this,t)}}const et=_.litHtmlPolyfillSupport;null==et||et(B,Y),(null!==(m=_.litHtmlVersions)&&void 0!==m?m:_.litHtmlVersions=[]).push("2.7.3");var it,ot;class nt extends g{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,e;const i=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=i.firstChild),i}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,i)=>{var o,n;const r=null!==(o=null==i?void 0:i.renderBefore)&&void 0!==o?o:e;let l=r._$litPart$;if(void 0===l){const t=null!==(n=null==i?void 0:i.renderBefore)&&void 0!==n?n:null;r._$litPart$=l=new Y(e.insertBefore(S(),t),t,void 0,null!=i?i:{})}return l._$AI(t),l})(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return I}}nt.finalized=!0,nt._$litElement$=!0,null===(it=globalThis.litElementHydrateSupport)||void 0===it||it.call(globalThis,{LitElement:nt});const rt=globalThis.litElementPolyfillSupport;null==rt||rt({LitElement:nt}),(null!==(ot=globalThis.litElementVersions)&&void 0!==ot?ot:globalThis.litElementVersions=[]).push("3.3.2");const lt=t=>e=>"function"==typeof e?((t,e)=>(customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:i,elements:o}=e;return{kind:i,elements:o,finisher(e){customElements.define(t,e)}}})(t,e),at=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?{...e,finisher(i){i.createProperty(e.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(i){i.createProperty(e.key,t)}};function st(t){return(e,i)=>void 0!==i?((t,e,i)=>{e.constructor.createProperty(i,t)})(t,e,i):at(t,e)}function dt(t){return st({...t,state:!0})}var ct;null===(ct=window.HTMLSlotElement)||void 0===ct||ct.prototype.assignedElements;var ut={version:"Version",invalid_configuration:"Invalid configuration",show_warning:"Show Warning",entity_not_found:"Entity state not found",missing_child:"Missing child entity",loading:"Loading..."},vt={yaml_disclaimer:"Please use yaml mode for the other options",docs:"Documentation",sections:"Sections",section:"Section",add_section:"+ Add section",add_entity:"+ Add entity",entity_editor:"Entity editor",decimals:"decimals",fields:{autoconfig:"Autoconfig",print_yaml:"Print auto generated config yaml",show_names:"Show names",show_icons:"Show icons",show_states:"Show states",show_units:"Show units",energy_date_selection:"Sync with energy_date_selection component",height:"Height",wide:"Wide",min_box_height:"Min box height",min_box_distance:"Min box distance",min_state:"Min state",round:"Round",throttle:"Throttle",unit_prefix:"Unit prefix",entity:"Entity",type:"Type",children:"Children",name:"Name",icon:"Icon",color:"Color",unit_of_measurement:"Unit of measurement",tap_action:"Tap action",color_on_state:"Change color based on state",color_limit:"State limit for color change",color_above:"Color above limit",color_below:"Color below limit"},entity_types:{entity:"Entity",remaining_parent_state:"Remaining parent state",remaining_child_state:"Remaining child state",passthrough:"Passthrough"}},ht={common:ut,editor:vt};const pt={en:Object.freeze({__proto__:null,common:ut,editor:vt,default:ht})};var yt,gt;function mt(){return(mt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t}).apply(this,arguments)}!function(t){t.language="language",t.system="system",t.comma_decimal="comma_decimal",t.decimal_comma="decimal_comma",t.space_comma="space_comma",t.none="none"}(yt||(yt={})),function(t){t.language="language",t.system="system",t.am_pm="12",t.twenty_four="24"}(gt||(gt={}));var _t=function(t,e){return void 0===e&&(e=2),Math.round(t*Math.pow(10,e))/Math.pow(10,e)},ft=function(t,e,i){var o=e?function(t){switch(t.number_format){case yt.comma_decimal:return["en-US","en"];case yt.decimal_comma:return["de","es","it"];case yt.space_comma:return["fr","sv","cs"];case yt.system:return;default:return t.language}}(e):void 0;if(Number.isNaN=Number.isNaN||function t(e){return"number"==typeof e&&t(e)},(null==e?void 0:e.number_format)!==yt.none&&!Number.isNaN(Number(t))&&Intl)try{return new Intl.NumberFormat(o,bt(t,i)).format(Number(t))}catch(e){return console.error(e),new Intl.NumberFormat(void 0,bt(t,i)).format(Number(t))}return"string"==typeof t?t:_t(t,null==i?void 0:i.maximumFractionDigits).toString()+("currency"===(null==i?void 0:i.style)?" "+i.currency:"")},bt=function(t,e){var i=mt({maximumFractionDigits:2},e);if("string"!=typeof t)return i;if(!e||!e.minimumFractionDigits&&!e.maximumFractionDigits){var o=t.indexOf(".")>-1?t.split(".")[1].length:0;i.minimumFractionDigits=o,i.maximumFractionDigits=o}return i};function $t(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}function wt(t,e=0){return $t(t)?Number(t):e}function xt(t,e=/\s+/){const i=[];if(null!=t){const o=Array.isArray(t)?t:`${t}`.split(e);for(const t of o){const e=`${t}`.trim();e&&i.push(e)}}return i}const kt=e=>{class i extends e{connectedCallback(){super.connectedCallback(),this.__checkSubscribed()}disconnectedCallback(){super.disconnectedCallback(),this.hassUnsubscribe()}updated(t){super.updated(t),t.has("hass")&&this.__checkSubscribed()}resetSubscriptions(){this.hassUnsubscribe(),this.__checkSubscribed()}hassSubscribe(){return[]}hassUnsubscribe(){if(this.__unsubs){for(;this.__unsubs.length;){const t=this.__unsubs.pop();t instanceof Promise?t.then((t=>t())):t()}this.__unsubs=void 0}}__checkSubscribed(){void 0===this.__unsubs&&this.isConnected&&void 0!==this.hass&&(this.__unsubs=this.hassSubscribe())}}return t([st({attribute:!1})],i.prototype,"hass",void 0),i};function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function St(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function At(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function Mt(t){At(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"===Et(t)&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}var Ct=36e5;function Pt(t,e){return At(2,arguments),function(t,e){At(2,arguments);var i=Mt(t).getTime(),o=St(e);return new Date(i+o)}(t,St(e)*Ct)}function Dt(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function Ot(t){At(1,arguments);var e=Mt(t);return e.setHours(0,0,0,0),e}var jt=864e5;function Nt(t,e){var i=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return i<0?-1:i>0?1:i}function zt(t,e){At(2,arguments);var i=Mt(t),o=Mt(e),n=Nt(i,o),r=Math.abs(function(t,e){At(2,arguments);var i=Ot(t),o=Ot(e),n=i.getTime()-Dt(i),r=o.getTime()-Dt(o);return Math.round((n-r)/jt)}(i,o));i.setDate(i.getDate()-n*r);var l=n*(r-Number(Nt(i,o)===-n));return 0===l?0:l}const Tt=(t,e="_energy")=>t.connection[e]?t.connection[e]:null,Rt=t=>{if(!t||t.length<2)return null;const e=t[t.length-1].sum;if(null===e)return null;const i=t[0].sum;return null===i?e:e-i};const Ht=1;class Ut{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}const It=(t=>(...e)=>({_$litDirective$:t,values:e}))(class extends Ut{constructor(t){var e;if(super(t),t.type!==Ht||"class"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((e=>t[e])).join(" ")+" "}update(t,[e]){var i,o;if(void 0===this.it){this.it=new Set,void 0!==t.strings&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter((t=>""!==t))));for(const t in e)e[t]&&!(null===(i=this.nt)||void 0===i?void 0:i.has(t))&&this.it.add(t);return this.render(e)}const n=t.element.classList;this.it.forEach((t=>{t in e||(n.remove(t),this.it.delete(t))}));for(const t in e){const i=!!e[t];i===this.it.has(t)||(null===(o=this.nt)||void 0===o?void 0:o.has(t))||(i?(n.add(t),this.it.add(t)):(n.remove(t),this.it.delete(t)))}return I}});var Wt="0.0.2.1";console.groupCollapsed(`%c⚡ Energy Flow Card Plus v${Wt} is installed`,"color: #488fc2; font-weight: bold"),console.log("Readme:","https://github.com/flixlix/energy-flow-card-plus"),console.groupEnd();const Ft=function(t,e,i){var o;return void 0===i&&(i=!1),function(){var n=[].slice.call(arguments),r=this,l=i&&!o;clearTimeout(o),o=setTimeout((function(){o=null,i||t.apply(r,n)}),e),l&&t.apply(r,n)}}((t=>{console.log(`%c⚡ Energy Flow Card Plus v${Wt} %cError: ${t}`,"color: #488fc2; font-weight: bold","color: #b33a3a; font-weight: normal")}),6e4),Lt=l`:host{--mdc-icon-size:24px;--clickable-cursor:pointer;--individualone-color:#d0cc5b;--individualtwo-color:#964cb5;--non-fossil-color:var(--energy-non-fossil-color, #0f9d58);--icon-non-fossil-color:var(--non-fossil-color, #0f9d58);--icon-solar-color:var(--energy-solar-color, #ff9800);--icon-individualone-color:var(--individualone-color, #d0cc5b);--icon-individualtwo-color:var(--individualtwo-color, #964cb5);--icon-grid-color:var(--energy-grid-consumption-color, #488fc2);--icon-battery-color:var(--energy-battery-in-color, #f06292);--icon-home-color:var(--energy-grid-consumption-color, #488fc2);--text-solar-color:var(--primary-text-color);--text-non-fossil-color:var(--primary-text-color);--text-individualone-color:var(--primary-text-color);--text-individualtwo-color:var(--primary-text-color);--text-home-color:var(--primary-text-color);--secondary-text-individualone-color:var(--primary-text-color);--secondary-text-individualtwo-color:var(--primary-text-color);--text-battery-state-of-charge-color:var(--primary-text-color);--cirlce-grid-color:var(--energy-grid-consumption-color, #488fc2);--circle-battery-color:var(--energy-battery-in-color, #f06292);--secondary-text-solar-color:var(--primary-text-color);--secondary-text-grid-color:var(--primary-text-color);--secondary-text-home-color:var(--primary-text-color);--secondary-text-non-fossil-color:var(--primary-text-color);--lines-svg-not-flat-line-height:106%;--lines-svg-not-flat-line-top:-3%}.card-content{position:relative;margin:0 auto}.card-content,.row{max-width:470px}.lines{position:absolute;bottom:0;left:0;width:100%;height:146px;display:flex;justify-content:center;padding:0 16px 16px;box-sizing:border-box}.lines.individual1-individual2{bottom:110px}.lines.high{bottom:100px;height:156px}.lines svg{width:calc(100% - 160px);height:100%;max-width:340px}.lines svg:not(.flat-line){width:calc(103% - 165px);height:var(--lines-svg-not-flat-line-height);top:var(--lines-svg-not-flat-line-top);position:relative}.row{display:flex;justify-content:space-between;max-width:500px;margin:0 auto}.circle-container{display:flex;flex-direction:column;align-items:center;z-index:2}.circle-container.solar{margin:0 4px;height:130px}.circle-container.individual2{margin-left:4px;height:130px}.circle-container.individual1{margin-left:4px;height:130px}.circle-container.individual1.bottom{position:relative;top:-20px;margin-bottom:-20px}.circle-container.battery{height:110px;justify-content:flex-end}.spacer{width:84px}.circle{width:80px;height:80px;border-radius:50%;box-sizing:border-box;border:2px solid;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;font-size:12px;line-height:12px;position:relative;text-decoration:none;color:var(--primary-text-color)}.circle-container .circle{cursor:var(--clickable-cursor)}#battery-grid{stroke:var(--energy-grid-return-color)}ha-icon{padding-bottom:2px}ha-icon.small{--mdc-icon-size:12px}.label{color:var(--secondary-text-color);font-size:12px;max-width:80px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}line,path{stroke:var(--disabled-text-color);stroke-width:1;fill:none}.circle svg{position:absolute;fill:none;stroke-width:4px;width:100%;height:100%;top:0;left:0}span.secondary-info{color:var(--primary-text-color);font-size:12px;max-width:60px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.individual2 circle,.individual2 path{stroke:var(--individualtwo-color)}#individual1-icon{color:var(--icon-individualone-color)}#individual2-icon{color:var(--icon-individualtwo-color)}#solar-icon{color:var(--icon-solar-color)}circle.individual2{stroke-width:4;fill:var(--individualtwo-color)}.individual2 .circle{border-color:var(--individualtwo-color)}.individual1 circle,.individual1 path{stroke:var(--individualone-color)}circle.individual1{stroke-width:4;fill:var(--individualone-color)}.individual1 .circle{border-color:var(--individualone-color)}.circle-container.low-carbon{margin-right:4px;height:130px}.low-carbon path{stroke:var(--non-fossil-color)}.low-carbon .circle{border-color:var(--non-fossil-color)}.low-carbon ha-icon:not(.small){color:var(--icon-non-fossil-color)}circle.low-carbon{stroke-width:4;fill:var(--non-fossil-color);stroke:var(--non-fossil-color)}.solar{color:var(--primary-text-color)}.solar .circle{border-color:var(--energy-solar-color)}.solar ha-icon:not(.small){color:var(--icon-solar-color)}circle.solar,path.solar{stroke:var(--energy-solar-color)}circle.solar{stroke-width:4;fill:var(--energy-solar-color)}.battery .circle{border-color:var(--circle-battery-color)}circle.battery,path.battery{stroke:var(--energy-battery-out-color)}circle.battery-home,path.battery-home{stroke:var(--energy-battery-out-color)}circle.battery-home{stroke-width:4;fill:var(--energy-battery-out-color)}circle.battery-solar,path.battery-solar{stroke:var(--energy-battery-in-color)}circle.battery-solar{stroke-width:4;fill:var(--energy-battery-in-color)}.battery-in{color:var(--energy-battery-in-color)}.battery-out{color:var(--energy-battery-out-color)}path.battery-from-grid{stroke:var(--energy-grid-consumption-color)}path.battery-to-grid{stroke:var(--energy-grid-return-color)}.battery ha-icon:not(.small){color:var(--icon-battery-color)}circle.battery-to-grid,circle.return,path.return{stroke:var(--energy-grid-return-color)}circle.battery-to-grid,circle.return{stroke-width:4;fill:var(--energy-grid-return-color)}.return{color:var(--energy-grid-return-color)}.grid .circle{border-color:var(--circle-grid-color)}.consumption{color:var(--energy-grid-consumption-color)}circle.battery-from-grid,circle.grid,path.grid{stroke:var(--energy-grid-consumption-color)}circle.battery-from-grid,circle.grid{stroke-width:4;fill:var(--energy-grid-consumption-color)}.grid ha-icon:not(.small){color:var(--icon-grid-color)}.home .circle{border-width:0;border-color:var(--primary-color)}.home .circle.border{border-width:2px}.home ha-icon:not(.small){color:var(--icon-home-color)}.circle svg circle{animation:rotate-in .6s ease-in;transition:stroke-dashoffset .4s,stroke-dasharray .4s;fill:none}span.solar{color:var(--text-solar-color)}span.low-carbon{color:var(--text-non-fossil-color)}span.low-carbon.secondary-info{color:var(--secondary-text-non-fossil-color)}#home-circle{color:var(--text-home-color)}.individual1 .circle{color:var(--text-individualone-color)}.individual2 .circle{color:var(--text-individualtwo-color)}.individual1 span.secondary-info{color:var(--secondary-text-individualone-color)}.individual2 span.secondary-info{color:var(--secondary-text-individualtwo-color)}.solar span.secondary-info{color:var(--secondary-text-solar-color)}.grid span.secondary-info{color:var(--secondary-text-grid-color)}.home span.secondary-info{color:var(--secondary-text-home-color)}#battery-state-of-charge-text{color:var(--text-battery-state-of-charge-color)}@keyframes rotate-in{from{stroke-dashoffset:238.76104;stroke-dasharray:238.76104}}.card-actions a{text-decoration:none}`,Vt=6,Bt=1,Zt=1,Gt=0,Yt=10,Kt=2e3,qt=1e3;!function(t){const e=window;e.customCards=e.customCards||[],e.customCards.push(Object.assign(Object.assign({},t),{preview:!0,documentationURL:"https://github.com/flixlix/energy-flow-card-plus"}))}({type:"energy-flow-card-plus",name:"Energy Flow Card Plus",description:"A custom card for displaying energy flow in Home Assistant. Inspired by the official Energy Distribution Card."});const Jt=238.76104;let Qt=class extends(kt(nt)){constructor(){super(...arguments),this.states={},this.entitiesArr=[],this.unavailableOrMisconfiguredError=t=>Ft(`Entity "${null!=t?t:"Unknown"}" is not available or misconfigured`),this.entityExists=t=>{var e;return(null===(e=this._config)||void 0===e?void 0:e.energy_date_selection)?t in this.states:t in this.hass.states},this.entityAvailable=t=>{var e,i,o;return(null===(e=this._config)||void 0===e?void 0:e.energy_date_selection)?$t(null===(i=this.states[t])||void 0===i?void 0:i.state):$t(null===(o=this.hass.states[t])||void 0===o?void 0:o.state)},this.entityInverted=t=>this._config.inverted_entities.includes(t),this.previousDur={},this.circleRate=(t,e)=>{const i=this._config.max_flow_rate,o=this._config.min_flow_rate;if(this._config.use_new_flow_rate_model){const e=this._config.max_expected_energy,n=this._config.min_expected_energy;return this.mapRange(t,i,o,n,e)}return i-t/e*(i-o)},this.getEntityStateObj=t=>{if(t&&this.entityAvailable(t))return this.hass.states[t];this.unavailableOrMisconfiguredError(t)},this.additionalCircleRate=(t,e)=>!0===t&&e?e:$t(t)?t:1.66,this.getEntityState=(t,e)=>{var i,o;if(!t||!this.entityAvailable(t))return this.unavailableOrMisconfiguredError(t),0;return wt((!1===(null===(i=this._config)||void 0===i?void 0:i.energy_date_selection)||e?null===(o=this.hass)||void 0===o?void 0:o.states[t]:this.states[t]).state)},this.getEntityStateWatthours=t=>{var e,i,o;if(!t||!this.entityAvailable(t))return this.unavailableOrMisconfiguredError(t),0;const n=!1!==(null===(e=this._config)||void 0===e?void 0:e.energy_date_selection)?this.states[t]:null===(i=this.hass)||void 0===i?void 0:i.states[t],r=wt(null==n?void 0:n.state);return(null===(o=null==n?void 0:n.attributes.unit_of_measurement)||void 0===o?void 0:o.toUpperCase().startsWith("KWH"))?1e3*r:r},this.displayValue=(t,e,i,o)=>{if(null===t)return"0";if(Number.isNaN(+t))return t;const n=Number(t),r=void 0===e&&n>=this._config.wh_kwh_threshold;return`${ft(r?_t(n/1e3,this._config.kwh_decimals):_t(n,null!=o?o:this._config.wh_decimals),this.hass.locale)}${!1===i?"":" "}${e||(r?"kWh":"Wh")}`},this.displayNonFossilState=t=>{var e,i,o,n,r;if(!t||!this.entityAvailable(t))return this.unavailableOrMisconfiguredError(t),"NaN";const l=null===(i=null===(e=this._config.entities.fossil_fuel_percentage)||void 0===e?void 0:e.unit_white_space)||void 0===i||i,a="percentage"===(null===(o=this._config.entities.fossil_fuel_percentage)||void 0===o?void 0:o.state_type)?"%":"Wh",s=1-this.getEntityState(t)/100,d=this.getEntityStateWatthours(this._config.entities.grid.entity.consumption)||0;let c;const u=null!==(r=null===(n=this._config.entities.fossil_fuel_percentage)||void 0===n?void 0:n.display_zero_tolerance)&&void 0!==r?r:0;if("percentage"!==this._config.entities.fossil_fuel_percentage.state_type){let t=d*s;u&&t<u&&(t=0),c=this.displayValue(t)}else{let e=100-this.getEntityState(t);u&&e<u&&(e=0),c=e.toFixed(0).toString().concat(!1===l?"":" ").concat(a)}return c}}static getStubConfig(t){return function(t){var e,i,o,n;function r(e,i){const o=t.states[e].attributes.friendly_name;return i.some((t=>e.includes(t)||(null==o?void 0:o.includes(t))))}const l=Object.keys(t.states).filter((e=>{const i=t.states[e];return i.state&&i.attributes&&"energy"===i.attributes.device_class||i.entity_id.includes("energy")})),a=["grid","utility","net","meter"],s=["solar","pv","photovoltaic","inverter"],d=["battery"],c=l.filter((t=>r(t,d))),u=l.filter((t=>r(t,a))),v=l.filter((t=>r(t,s)))[0];return{type:"custom:energy-flow-card-plus",entities:{battery:{entity:{consumption:null!==(e=c[0])&&void 0!==e?e:"",production:null!==(i=c[1])&&void 0!==i?i:""}},grid:{entity:{consumption:null!==(o=u[0])&&void 0!==o?o:"",production:null!==(n=u[1])&&void 0!==n?n:""}},solar:v?{entity:v,display_zero_state:!0}:void 0},clickable_entities:!0,display_zero_lines:!0,use_new_flow_rate_model:!0,energy_date_selection:!0,wh_decimals:Zt,kwh_decimals:Gt,min_flow_rate:Bt,max_flow_rate:Vt,max_expected_energy:Kt,min_expected_energy:Yt,wh_kwh_threshold:qt}}(t)}static async getConfigElement(){return await Promise.resolve().then((function(){return ze})),document.createElement("energy-flow-card-plus-editor")}hassSubscribe(){var t;if(!1===(null===(t=this._config)||void 0===t?void 0:t.energy_date_selection))return[];const e=Date.now(),i=(t,o)=>{const n=Tt(this.hass);n?t(n):Date.now()-e>1e4?(console.debug(Tt(this.hass)),o(new Error("No energy data received. Make sure to add a `type: energy-date-selection` card to this screen."))):setTimeout((()=>i(t,o)),100)},o=new Promise(i);return setTimeout((()=>{this.error||Object.keys(this.states).length||(this.error=new Error("Something went wrong. No energy data received."),console.debug(Tt(this.hass)))}),2e4),o.catch((t=>{this.error=t})),[o.then((async t=>t.subscribe((async t=>{if(this.entitiesArr){const e=await async function(t,e,i){const o=zt(e.end||new Date,e.start),n=Pt(e.start,-1),r=o>35?"month":o>2?"day":"hour",l=await((t,e,i,o,n="hour")=>t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==i?void 0:i.toISOString(),statistic_ids:o,period:n}))(t,n,e.end,i,r);return Object.values(l).forEach((t=>{t.length&&new Date(t[0].start)>n&&t.unshift(Object.assign(Object.assign({},t[0]),{start:n.toISOString(),end:n.toISOString(),sum:0,state:0}))})),i.reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:Rt(l[e])})),{})}(this.hass,t,this.entitiesArr),i={};Object.keys(e).forEach((t=>{this.hass.states[t]&&(i[t]=Object.assign(Object.assign({},this.hass.states[t]),{state:String(e[t])}))})),this.states=i}}))))]}setConfig(t){var e,i,o,n,r,l;if("object"!=typeof t)throw new Error(function(t,e="",i=""){const o=(localStorage.getItem("selectedLanguage")||"en").replace(/['"]+/g,"").replace("-","_");let n;try{n=t.split(".").reduce(((t,e)=>t[e]),pt[o])}catch(e){n=t.split(".").reduce(((t,e)=>t[e]),pt.en)}return void 0===n&&(n=t.split(".").reduce(((t,e)=>t&&t[e]),pt.en)),""!==e&&""!==i&&(n=n.replace(e,i)),n}("common.invalid_configuration"));if(!t.entities||!(null===(i=null===(e=t.entities)||void 0===e?void 0:e.battery)||void 0===i?void 0:i.entity)&&!(null===(n=null===(o=t.entities)||void 0===o?void 0:o.grid)||void 0===n?void 0:n.entity)&&!(null===(l=null===(r=t.entities)||void 0===r?void 0:r.solar)||void 0===l?void 0:l.entity))throw new Error("At least one entity for battery, grid or solar must be defined");this._config=Object.assign(Object.assign({},t),{inverted_entities:xt(t.inverted_entities,","),kwh_decimals:wt(t.kwh_decimals,Gt),min_flow_rate:wt(t.min_flow_rate,Bt),max_flow_rate:wt(t.max_flow_rate,Vt),wh_decimals:wt(t.wh_decimals,Zt),wh_kwh_threshold:wt(t.wh_kwh_threshold,qt),max_expected_energy:wt(t.max_expected_energy,Kt),min_expected_energy:wt(t.min_expected_energy,Yt)}),this.populateEntitiesArr(),this.resetSubscriptions()}populateEntitiesArr(){var t;this.entitiesArr=[],Object.keys(null===(t=this._config)||void 0===t?void 0:t.entities).forEach((t=>{var e,i;"string"==typeof this._config.entities[t].entity?this.entitiesArr.push(this._config.entities[t].entity):"object"==typeof this._config.entities[t].entity&&(this.entitiesArr.push(null===(e=this._config.entities[t].entity)||void 0===e?void 0:e.consumption),this.entitiesArr.push(null===(i=this._config.entities[t].entity)||void 0===i?void 0:i.production))}))}getCardSize(){return 3}mapRange(t,e,i,o,n){return t>n?i:(t-o)*(i-e)/(n-o)+e}openDetails(t){if(!t||!this._config.clickable_entities)return;if(!this.entityExists(t))return;const e=new CustomEvent("hass-more-info",{composed:!0,detail:{entityId:t}});this.dispatchEvent(e)}hasField(t,e){var i,o;return!!(void 0!==t&&!0===(null==t?void 0:t.display_zero)||this.getEntityStateWatthours(null==t?void 0:t.entity)>(null!==(i=null==t?void 0:t.display_zero_tolerance)&&void 0!==i?i:0)&&this.entityAvailable(null==t?void 0:t.entity)||e)&&"string"==typeof(null===(o=this.hass.states[null==t?void 0:t.entity])||void 0===o?void 0:o.state)}showLine(t){var e;return!1!==(null===(e=this._config)||void 0===e?void 0:e.display_zero_lines)||t>0}render(){var t,e,i,o,n,r,l,a,s,d,c,u,v,h,p,y,g,m,_,f,b,$,w,x,k,E,S,A,M,C,P,D,O,j,N,z,T,R,I,W,F,L,V,B,Z,G,Y,K,q,J,Q,X,tt,et,it,ot,nt,rt,lt,at,st,dt,ct,ut,vt,ht,pt,yt,gt,mt,_t,bt,$t,xt,kt,Et,St,At,Mt,Ct,Pt,Dt,Ot,jt,Nt,zt,Tt,Rt,Ht,Ut,Wt,Ft,Lt,Vt,Bt,Zt,Gt,Yt,Kt,qt,Qt,Xt,te,ee,ie,oe,ne,re,le,ae,se,de,ce,ue,ve,he,pe,ye,ge,me,_e,fe,be,$e,we,xe,ke,Ee,Se,Ae,Me,Ce,Pe,De,Oe,je,Ne,ze,Te,Re,He,Ue,Ie,We,Fe,Le,Ve,Be,Ze,Ge,Ye,Ke,qe,Je,Qe,Xe,ti,ei,ii,oi,ni,ri,li,ai,si,di,ci,ui,vi,hi,pi,yi,gi,mi,_i,fi,bi,$i,wi,xi,ki,Ei,Si,Ai,Mi,Ci,Pi,Di,Oi,ji,Ni,zi,Ti,Ri,Hi,Ui,Ii,Wi,Fi,Li,Vi,Bi,Zi,Gi,Yi,Ki,qi,Ji,Qi,Xi,to,eo,io,oo,no,ro,lo,ao,so,co,uo,vo,ho,po,yo,go,mo,_o,fo,bo,$o,wo,xo,ko,Eo,So,Ao,Mo,Co,Po,Do,Oo,jo,No,zo,To;if(!this._config||!this.hass)return H``;const{entities:Ro}=this._config;function Ho(t){return"#".concat(t.map((t=>t.toString(16).padStart(2,"0"))).join(""))}this.style.setProperty("--clickable-cursor",this._config.clickable_entities?"pointer":"default");const Uo=void 0!==(null===(t=null==Ro?void 0:Ro.grid)||void 0===t?void 0:t.entity),Io=this.hasField(null===(e=Ro.grid)||void 0===e?void 0:e.power_outage,!0)&&this.hass.states[Ro.grid.power_outage.entity].state===(null!==(o=null===(i=Ro.grid)||void 0===i?void 0:i.power_outage.state_alert)&&void 0!==o?o:"on"),Wo=void 0!==(null===(n=null==Ro?void 0:Ro.battery)||void 0===n?void 0:n.entity),Fo=this.hasField(Ro.individual2),Lo=this.hasField(null===(r=Ro.individual2)||void 0===r?void 0:r.secondary_info,!0),Vo=this.hasField(Ro.individual1),Bo=this.hasField(null===(l=Ro.individual1)||void 0===l?void 0:l.secondary_info,!0),Zo=void 0!==Ro.solar,Go=this.hasField(null===(a=Ro.solar)||void 0===a?void 0:a.secondary_info),Yo=this.hasField(null===(s=Ro.home)||void 0===s?void 0:s.secondary_info),Ko=Uo&&("string"==typeof Ro.grid.entity||Ro.grid.entity.production);let qo=0,Jo=0,Qo=null===(c=null===(d=this._config.entities.grid)||void 0===d?void 0:d.color)||void 0===c?void 0:c.consumption;void 0!==Qo&&("object"==typeof Qo&&(Qo=Ho(Qo)),this.style.setProperty("--energy-grid-consumption-color",Qo||"var(--energy-grid-consumption-color)")),Uo&&(qo="string"==typeof Ro.grid.entity?this.entityInverted("grid")?Math.abs(Math.min(this.getEntityStateWatthours(null===(u=Ro.grid)||void 0===u?void 0:u.entity),0)):Math.max(this.getEntityStateWatthours(null===(v=Ro.grid)||void 0===v?void 0:v.entity),0):this.getEntityStateWatthours(Ro.grid.entity.consumption)),void 0!==(null===(h=this._config.entities.grid)||void 0===h?void 0:h.display_zero_tolerance)&&(qo=qo>(null===(p=this._config.entities.grid)||void 0===p?void 0:p.display_zero_tolerance)?qo:0);const Xo=this.hasField(null===(y=Ro.grid)||void 0===y?void 0:y.secondary_info);let tn=null;if(Xo){const t=this.hass.states[null!==(_=null===(m=null===(g=this._config.entities.grid)||void 0===g?void 0:g.secondary_info)||void 0===m?void 0:m.entity)&&void 0!==_?_:0],e=Number(t.state);tn=this.entityInverted("gridSecondary")?Math.abs(Math.min(e,0)):Math.max(e,0)}let en=null===(b=null===(f=this._config.entities.grid)||void 0===f?void 0:f.color)||void 0===b?void 0:b.production;void 0!==en&&("object"==typeof en&&(en=Ho(en)),this.style.setProperty("--energy-grid-return-color",en||"#a280db")),Ko&&(Jo="string"==typeof Ro.grid.entity?this.entityInverted("grid")?Math.max(this.getEntityStateWatthours(Ro.grid.entity),0):Math.abs(Math.min(this.getEntityStateWatthours(Ro.grid.entity),0)):this.getEntityStateWatthours(null===($=Ro.grid)||void 0===$?void 0:$.entity.production)),void 0!==(null===(w=this._config.entities.grid)||void 0===w?void 0:w.display_zero_tolerance)&&(Jo=Jo>(null===(x=this._config.entities.grid)||void 0===x?void 0:x.display_zero_tolerance)?Jo:0);const on=(null===(k=Ro.grid.entity)||void 0===k?void 0:k.consumption)||(null===(E=Ro.grid.entity)||void 0===E?void 0:E.production),nn=Io?(null===(C=Ro.grid)||void 0===C?void 0:C.power_outage.icon_alert)||"mdi:transmission-tower-off":(null===(S=Ro.grid)||void 0===S?void 0:S.icon)||(null===(A=Ro.grid)||void 0===A?void 0:A.use_metadata)&&(null===(M=this.getEntityStateObj(on))||void 0===M?void 0:M.attributes.icon)||"mdi:transmission-tower",rn=(null===(P=Ro.grid)||void 0===P?void 0:P.name)||(null===(D=Ro.grid)||void 0===D?void 0:D.use_metadata)&&(null===(O=this.getEntityStateObj(on))||void 0===O?void 0:O.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.grid"),ln=null===(j=Ro.grid)||void 0===j?void 0:j.color_icon;this.style.setProperty("--icon-grid-color","consumption"===ln?"var(--energy-grid-consumption-color)":"production"===ln?"var(--energy-grid-return-color)":!0===ln?qo>=Jo?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--primary-text-color)");const an=null===(z=null===(N=this._config.entities.grid)||void 0===N?void 0:N.secondary_info)||void 0===z?void 0:z.color_value;this.style.setProperty("--secondary-text-grid-color","consumption"===an?"var(--energy-grid-consumption-color)":"production"===an?"var(--energy-grid-return-color)":!0===an?qo>=Jo?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--primary-text-color)");const sn=null===(T=this._config.entities.grid)||void 0===T?void 0:T.color_circle;this.style.setProperty("--circle-grid-color","consumption"===sn?"var(--energy-grid-consumption-color)":"production"===sn?"var(--energy-grid-return-color)":!0===sn?qo>=Jo?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--energy-grid-consumption-color)");const dn=function(t){const e=getComputedStyle(t||document.body),{width:i}=e,o=parseFloat(i);return Number.isNaN(o)?0:o}(document.getElementById("card-content"))>420;this.style.setProperty("--lines-svg-not-flat-line-height",dn?"106%":"102%"),this.style.setProperty("--lines-svg-not-flat-line-top",dn?"-3%":"-1%");const cn=Vo?this.getEntityStateWatthours(null===(R=Ro.individual1)||void 0===R?void 0:R.entity):0;let un=null;const vn=(null===(I=this._config.entities.individual1)||void 0===I?void 0:I.name)||(null===(F=this.getEntityStateObj(null===(W=Ro.individual1)||void 0===W?void 0:W.entity))||void 0===F?void 0:F.attributes.friendly_name)||"Car",hn=(null===(L=this._config.entities.individual1)||void 0===L?void 0:L.icon)||(null===(B=this.getEntityStateObj(null===(V=Ro.individual1)||void 0===V?void 0:V.entity))||void 0===B?void 0:B.attributes.icon)||"mdi:car-electric";let pn=null===(Z=this._config.entities.individual1)||void 0===Z?void 0:Z.color;void 0!==pn&&("object"==typeof pn&&(pn=Ho(pn)),this.style.setProperty("--individualone-color",pn)),this.style.setProperty("--icon-individualone-color",(null===(G=this._config.entities.individual1)||void 0===G?void 0:G.color_icon)?"var(--individualone-color)":"var(--primary-text-color)");const yn=Fo?this.getEntityStateWatthours(null===(Y=Ro.individual2)||void 0===Y?void 0:Y.entity):0;if(Bo){const t=this.hass.states[null===(q=null===(K=this._config.entities.individual1)||void 0===K?void 0:K.secondary_info)||void 0===q?void 0:q.entity].state;"number"==typeof t?un=this.entityInverted("individual1Secondary")?Math.abs(Math.min(t,0)):Math.max(t,0):"string"==typeof t&&(un=t)}let gn=null;const mn=(null===(J=this._config.entities.individual2)||void 0===J?void 0:J.name)||(null===(X=this.getEntityStateObj(null===(Q=Ro.individual2)||void 0===Q?void 0:Q.entity))||void 0===X?void 0:X.attributes.friendly_name)||"Motorcycle",_n=(null===(tt=this._config.entities.individual2)||void 0===tt?void 0:tt.icon)||(null===(it=this.getEntityStateObj(null===(et=Ro.individual2)||void 0===et?void 0:et.entity))||void 0===it?void 0:it.attributes.icon)||"mdi:motorbike-electric";let fn=null===(ot=this._config.entities.individual2)||void 0===ot?void 0:ot.color;if(void 0!==fn&&("object"==typeof fn&&(fn=Ho(fn)),this.style.setProperty("--individualtwo-color",fn)),this.style.setProperty("--icon-individualtwo-color",(null===(nt=this._config.entities.individual2)||void 0===nt?void 0:nt.color_icon)?"var(--individualtwo-color)":"var(--primary-text-color)"),Lo){const t=this.hass.states[null===(lt=null===(rt=this._config.entities.individual2)||void 0===rt?void 0:rt.secondary_info)||void 0===lt?void 0:lt.entity].state;"number"==typeof t?gn=this.entityInverted("individual2Secondary")?Math.abs(Math.min(t,0)):Math.max(t,0):"string"==typeof t&&(gn=t)}let bn=null;if(Go){const t=this.hass.states[null===(st=null===(at=this._config.entities.solar)||void 0===at?void 0:at.secondary_info)||void 0===st?void 0:st.entity],e=Number(t.state);bn=this.entityInverted("solarSecondary")?Math.abs(Math.min(e,0)):Math.max(e,0)}let $n=null;if(Yo){const t=this.hass.states[null===(ct=null===(dt=this._config.entities.home)||void 0===dt?void 0:dt.secondary_info)||void 0===ct?void 0:ct.entity],e=Number(t.state);$n=this.entityInverted("homeSecondary")?Math.abs(Math.min(e,0)):Math.max(e,0)}let wn=0;if(void 0!==(null===(ut=this._config.entities.solar)||void 0===ut?void 0:ut.color)){let t=null===(vt=this._config.entities.solar)||void 0===vt?void 0:vt.color;"object"==typeof t&&(t=Ho(t)),this.style.setProperty("--energy-solar-color",t||"#ff9800")}this.style.setProperty("--icon-solar-color",(null===(ht=this._config.entities.solar)||void 0===ht?void 0:ht.color_icon)?"var(--energy-solar-color)":"var(--primary-text-color)"),Zo&&(wn=this.entityInverted("solar")?Math.abs(Math.min(this.getEntityStateWatthours(null===(pt=Ro.solar)||void 0===pt?void 0:pt.entity),0)):Math.max(this.getEntityStateWatthours(null===(yt=Ro.solar)||void 0===yt?void 0:yt.entity),0),(null===(gt=Ro.solar)||void 0===gt?void 0:gt.display_zero_tolerance)&&Ro.solar.display_zero_tolerance>=wn&&(wn=0));let xn=0,kn=0;Wo&&("string"==typeof(null===(mt=Ro.battery)||void 0===mt?void 0:mt.entity)?(xn=this.entityInverted("battery")?Math.max(this.getEntityStateWatthours(Ro.battery.entity),0):Math.abs(Math.min(this.getEntityStateWatthours(Ro.battery.entity),0)),kn=this.entityInverted("battery")?Math.abs(Math.min(this.getEntityStateWatthours(Ro.battery.entity),0)):Math.max(this.getEntityStateWatthours(Ro.battery.entity),0)):(xn=this.getEntityStateWatthours(null===(bt=null===(_t=Ro.battery)||void 0===_t?void 0:_t.entity)||void 0===bt?void 0:bt.production),kn=this.getEntityStateWatthours(null===(xt=null===($t=Ro.battery)||void 0===$t?void 0:$t.entity)||void 0===xt?void 0:xt.consumption)),(null===(kt=null==Ro?void 0:Ro.battery)||void 0===kt?void 0:kt.display_zero_tolerance)&&(Ro.battery.display_zero_tolerance>=xn&&(xn=0),Ro.battery.display_zero_tolerance>=kn&&(kn=0)));let En=null;Zo&&(En=wn-(null!=Jo?Jo:0)-(null!=xn?xn:0));let Sn=null,An=null;null!==En&&En<0&&(Wo&&(Sn=Math.abs(En),Sn>qo&&(An=Math.min(Sn-qo,0),Sn=qo)),En=0);let Mn=null;Zo&&Wo?(An||(An=Math.max(0,(Jo||0)-(wn||0)-(xn||0)-(Sn||0))),Mn=xn-(Sn||0)):!Zo&&Wo&&(An=Jo);let Cn=0;Zo&&Jo&&(Cn=Jo-(null!=An?An:0));let Pn=0;Wo&&(Pn=(null!=kn?kn:0)-(null!=An?An:0));let Dn=null===(St=null===(Et=this._config.entities.battery)||void 0===Et?void 0:Et.color)||void 0===St?void 0:St.consumption;void 0!==Dn&&("object"==typeof Dn&&(Dn=Ho(Dn)),this.style.setProperty("--energy-battery-out-color",Dn||"#4db6ac"));let On=null===(Mt=null===(At=this._config.entities.battery)||void 0===At?void 0:At.color)||void 0===Mt?void 0:Mt.production;void 0!==On&&("object"==typeof On&&(On=Ho(On)),this.style.setProperty("--energy-battery-in-color",On||"#a280db"));const jn=(null===(Pt=null===(Ct=null==Ro?void 0:Ro.battery)||void 0===Ct?void 0:Ct.entity)||void 0===Pt?void 0:Pt.consumption)||(null===(Ot=null===(Dt=Ro.battery)||void 0===Dt?void 0:Dt.entity)||void 0===Ot?void 0:Ot.production),Nn=(null===(jt=Ro.battery)||void 0===jt?void 0:jt.name)||(null===(Nt=Ro.battery)||void 0===Nt?void 0:Nt.use_metadata)&&(null===(zt=this.getEntityStateObj(jn))||void 0===zt?void 0:zt.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.battery"),zn=null===(Tt=this._config.entities.battery)||void 0===Tt?void 0:Tt.color_icon;this.style.setProperty("--icon-battery-color","consumption"===zn?"var(--energy-battery-in-color)":"production"===zn?"var(--energy-battery-out-color)":!0===zn?kn>=xn?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)":"var(--primary-text-color)");const Tn=null===(Rt=this._config.entities.battery)||void 0===Rt?void 0:Rt.color_state_of_charge_value;this.style.setProperty("--text-battery-state-of-charge-color","consumption"===Tn?"var(--energy-battery-in-color)":"production"===Tn?"var(--energy-battery-out-color)":!0===Tn?kn>=xn?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)":"var(--primary-text-color)");const Rn=null===(Ht=this._config.entities.battery)||void 0===Ht?void 0:Ht.color_circle;this.style.setProperty("--circle-battery-color","consumption"===Rn?"var(--energy-battery-in-color)":"production"===Rn||!0===Rn&&kn>=xn?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)");const Hn=Math.max(qo-(null!=Sn?Sn:0),0),Un=wt(cn,0)+wt(yn,0),In=Math.max(Hn+(null!=En?En:0)+(null!=Pn?Pn:0),0);let Wn=0;Pn&&(Wn=Jt*(Pn/In));let Fn=0;Zo&&(Fn=Jt*(En/In));const Ln=this.hasField(null===(Ut=Ro.fossil_fuel_percentage)||void 0===Ut?void 0:Ut.secondary_info,!0);let Vn=null;if(Ln){const t=this.hass.states[null===(Ft=null===(Wt=this._config.entities.fossil_fuel_percentage)||void 0===Wt?void 0:Wt.secondary_info)||void 0===Ft?void 0:Ft.entity].state;"number"==typeof t?Vn=this.entityInverted("nonFossilSecondary")?Math.abs(Math.min(t,0)):Math.max(t,0):"string"==typeof t&&(Vn=t)}const Bn=1*Hn-this.getEntityState(null===(Lt=Ro.fossil_fuel_percentage)||void 0===Lt?void 0:Lt.entity)/100>0&&void 0!==(null===(Vt=Ro.fossil_fuel_percentage)||void 0===Vt?void 0:Vt.entity)&&this.entityAvailable(null===(Bt=Ro.fossil_fuel_percentage)||void 0===Bt?void 0:Bt.entity),Zn=void 0!==(null===(Zt=Ro.fossil_fuel_percentage)||void 0===Zt?void 0:Zt.entity)&&!0===(null===(Gt=Ro.fossil_fuel_percentage)||void 0===Gt?void 0:Gt.display_zero)||Bn;let Gn,Yn=0;if(Bn){Gn=Hn*(1-this.getEntityState(null===(Yt=Ro.fossil_fuel_percentage)||void 0===Yt?void 0:Yt.entity)/100),Yn=Jt*(Gn/In)}const Kn=Jt*((In-(null!=Gn?Gn:0)-(null!=Pn?Pn:0)-(null!=En?En:0))/In),qn=Hn+(null!=En?En:0)+Cn+(null!=Mn?Mn:0)+(null!=Pn?Pn:0)+(null!=Sn?Sn:0)+(null!=An?An:0),Jn=(null===(Kt=null==Ro?void 0:Ro.battery)||void 0===Kt?void 0:Kt.state_of_charge)?this.getEntityState(null===(qt=Ro.battery)||void 0===qt?void 0:qt.state_of_charge,!0):null;let Qn="mdi:battery-high";null===Jn?Qn="mdi:battery-high":Jn<=72&&Jn>44?Qn="mdi:battery-medium":Jn<=44&&Jn>16?Qn="mdi:battery-low":Jn<=16&&(Qn="mdi:battery-outline"),void 0!==(null===(Qt=Ro.battery)||void 0===Qt?void 0:Qt.icon)&&(Qn=null===(Xt=Ro.battery)||void 0===Xt?void 0:Xt.icon);const Xn={batteryGrid:this.circleRate(null!==(te=null!=Sn?Sn:An)&&void 0!==te?te:0,qn),batteryToHome:this.circleRate(null!=Pn?Pn:0,qn),gridToHome:this.circleRate(Hn,qn),solarToBattery:this.circleRate(null!=Mn?Mn:0,qn),solarToGrid:this.circleRate(Cn,qn),solarToHome:this.circleRate(null!=En?En:0,qn),individual1:this.circleRate(null!=cn?cn:0,Un),individual2:this.circleRate(null!=yn?yn:0,Un),nonFossil:this.circleRate(null!=Gn?Gn:0,qn)};["batteryGrid","batteryToHome","gridToHome","solarToBattery","solarToGrid","solarToHome"].forEach((t=>{const e=this[`${t}Flow`];e&&this.previousDur[t]&&this.previousDur[t]!==Xn[t]&&(e.pauseAnimations(),e.setCurrentTime(e.getCurrentTime()*(Xn[t]/this.previousDur[t])),e.unpauseAnimations()),this.previousDur[t]=Xn[t]}));let tr=null===(ee=this._config.entities.fossil_fuel_percentage)||void 0===ee?void 0:ee.color;void 0!==tr&&("object"==typeof tr&&(tr=Ho(tr)),this.style.setProperty("--non-fossil-color",tr||"var(--energy-non-fossil-color)")),this.style.setProperty("--icon-non-fossil-color",(null===(ie=this._config.entities.fossil_fuel_percentage)||void 0===ie?void 0:ie.color_icon)?"var(--non-fossil-color)":"var(--primary-text-color)");const er=null===(oe=this._config.entities.home)||void 0===oe?void 0:oe.color_icon,ir={battery:{value:Wn,color:"var(--energy-battery-out-color)"},solar:{value:Fn,color:"var(--energy-solar-color)"},grid:{value:Kn,color:"var(--energy-grid-consumption-color)"},gridNonFossil:{value:Yn,color:"var(--energy-non-fossil-color)"}},or=Object.keys(ir).reduce(((t,e)=>ir[t].value>ir[e].value?t:e));let nr="var(--primary-text-color)";"solar"===er?nr="var(--energy-solar-color)":"battery"===er?nr="var(--energy-battery-out-color)":"grid"===er?nr="var(--energy-grid-consumption-color)":!0===er&&(nr=ir[or].color),this.style.setProperty("--icon-home-color",nr);const rr=null===(ne=this._config.entities.home)||void 0===ne?void 0:ne.color_value;let lr="var(--primary-text-color)";"solar"===rr?lr="var(--energy-solar-color)":"battery"===rr?lr="var(--energy-battery-out-color)":"grid"===rr?lr="var(--energy-grid-consumption-color)":!0===rr&&(lr=ir[or].color);const ar=(null===(re=Ro.solar)||void 0===re?void 0:re.icon)||(null===(le=Ro.solar)||void 0===le?void 0:le.use_metadata)&&(null===(se=null===(ae=this.getEntityStateObj(Ro.solar.entity))||void 0===ae?void 0:ae.attributes)||void 0===se?void 0:se.icon)||"mdi:solar-power",sr=(null===(de=Ro.solar)||void 0===de?void 0:de.name)||(null===(ce=Ro.solar)||void 0===ce?void 0:ce.use_metadata)&&(null===(ue=this.getEntityStateObj(Ro.solar.entity))||void 0===ue?void 0:ue.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.solar"),dr=(null===(ve=Ro.home)||void 0===ve?void 0:ve.icon)||(null===(he=Ro.home)||void 0===he?void 0:he.use_metadata)&&(null===(ye=null===(pe=this.getEntityStateObj(Ro.home.entity))||void 0===pe?void 0:pe.attributes)||void 0===ye?void 0:ye.icon)||"mdi:home",cr=(null===(ge=Ro.home)||void 0===ge?void 0:ge.name)||(null===(me=Ro.home)||void 0===me?void 0:me.use_metadata)&&(null===(_e=this.getEntityStateObj(Ro.home.entity))||void 0===_e?void 0:_e.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.home"),ur=(null===(fe=Ro.fossil_fuel_percentage)||void 0===fe?void 0:fe.icon)||(null===(be=Ro.fossil_fuel_percentage)||void 0===be?void 0:be.use_metadata)&&(null===(we=null===($e=this.getEntityStateObj(Ro.fossil_fuel_percentage.entity))||void 0===$e?void 0:$e.attributes)||void 0===we?void 0:we.icon)||"mdi:leaf",vr=(null===(xe=Ro.fossil_fuel_percentage)||void 0===xe?void 0:xe.name)||(null===(ke=Ro.fossil_fuel_percentage)||void 0===ke?void 0:ke.use_metadata)&&(null===(Ee=this.getEntityStateObj(Ro.fossil_fuel_percentage.entity))||void 0===Ee?void 0:Ee.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.low_carbon"),hr=this.displayValue(cn,null===(Se=this._config.entities.individual1)||void 0===Se?void 0:Se.unit_of_measurement,void 0,null===(Ae=Ro.individual1)||void 0===Ae?void 0:Ae.decimals),pr=this.displayValue(yn,null===(Me=this._config.entities.individual2)||void 0===Me?void 0:Me.unit_of_measurement,void 0,null===(Ce=Ro.individual2)||void 0===Ce?void 0:Ce.decimals);this.style.setProperty("--text-home-color",lr),this.style.setProperty("--text-solar-color",(null===(Pe=this._config.entities.solar)||void 0===Pe?void 0:Pe.color_value)?"var(--energy-solar-color)":"var(--primary-text-color)"),this.style.setProperty("--text-non-fossil-color",(null===(De=this._config.entities.fossil_fuel_percentage)||void 0===De?void 0:De.color_value)?"var(--energy-non-fossil-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-non-fossil-color",(null===(je=null===(Oe=this._config.entities.fossil_fuel_percentage)||void 0===Oe?void 0:Oe.secondary_info)||void 0===je?void 0:je.color_value)?"var(--energy-non-fossil-color)":"var(--primary-text-color)"),this.style.setProperty("--text-individualone-color",(null===(Ne=this._config.entities.individual1)||void 0===Ne?void 0:Ne.color_value)?"var(--individualone-color)":"var(--primary-text-color)"),this.style.setProperty("--text-individualtwo-color",(null===(ze=this._config.entities.individual2)||void 0===ze?void 0:ze.color_value)?"var(--individualtwo-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-individualone-color",(null===(Re=null===(Te=this._config.entities.individual1)||void 0===Te?void 0:Te.secondary_info)||void 0===Re?void 0:Re.color_value)?"var(--individualone-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-individualtwo-color",(null===(Ue=null===(He=this._config.entities.individual2)||void 0===He?void 0:He.secondary_info)||void 0===Ue?void 0:Ue.color_value)?"var(--individualtwo-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-solar-color",(null===(We=null===(Ie=this._config.entities.solar)||void 0===Ie?void 0:Ie.secondary_info)||void 0===We?void 0:We.color_value)?"var(--energy-solar-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-home-color",(null===(Le=null===(Fe=this._config.entities.home)||void 0===Fe?void 0:Fe.secondary_info)||void 0===Le?void 0:Le.color_value)?"var(--text-home-color)":"var(--primary-text-color)");const yr=(null===(Ve=this._config.entities.home)||void 0===Ve?void 0:Ve.override_state)&&this._config.entities.home.entity?(null===(Be=Ro.home)||void 0===Be?void 0:Be.subtract_individual)?this.displayValue(this.getEntityStateWatthours(Ro.home.entity)-Un):this.displayValue(this.getEntityStateWatthours(Ro.home.entity)):(null===(Ze=this._config.entities.home)||void 0===Ze?void 0:Ze.subtract_individual)?this.displayValue(In-Un||0):this.displayValue(In);return H`<ha-card .header="${this._config.title}"><div class="card-content" id="card-content">${Zo||Fo||Vo||Zn?H`<div class="row">${Zn?H`<div class="circle-container low-carbon"><span class="label">${vr}</span><div class="circle" @click="${t=>{var e;t.stopPropagation(),this.openDetails(null===(e=Ro.fossil_fuel_percentage)||void 0===e?void 0:e.entity)}}" @keyDown="${t=>{var e;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(e=Ro.fossil_fuel_percentage)||void 0===e?void 0:e.entity))}}">${Ln?H`<span class="secondary-info low-carbon" @click="${t=>{var e,i;t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.fossil_fuel_percentage)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity)}}" @keyDown="${t=>{var e,i;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.fossil_fuel_percentage)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity))}}">${(null===(Ye=null===(Ge=Ro.fossil_fuel_percentage)||void 0===Ge?void 0:Ge.secondary_info)||void 0===Ye?void 0:Ye.icon)?H`<ha-icon class="secondary-info small" .icon="${null===(qe=null===(Ke=Ro.fossil_fuel_percentage)||void 0===Ke?void 0:Ke.secondary_info)||void 0===qe?void 0:qe.icon}"></ha-icon>`:""} ${this.displayValue(Vn,null===(Qe=null===(Je=Ro.fossil_fuel_percentage)||void 0===Je?void 0:Je.secondary_info)||void 0===Qe?void 0:Qe.unit_of_measurement,null===(ti=null===(Xe=Ro.fossil_fuel_percentage)||void 0===Xe?void 0:Xe.secondary_info)||void 0===ti?void 0:ti.unit_white_space)}</span>`:""}<ha-icon .icon="${ur}" class="low-carbon" style="${Ln?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(ei=Ro.fossil_fuel_percentage)||void 0===ei?void 0:ei.display_zero_state)||(Gn||0)>((null===(ii=Ro.fossil_fuel_percentage)||void 0===ii?void 0:ii.display_zero_tolerance)||0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(oi=Ro.fossil_fuel_percentage)||void 0===oi?void 0:oi.display_zero_state)||(Gn||0)>((null===(ni=Ro.fossil_fuel_percentage)||void 0===ni?void 0:ni.display_zero_tolerance)||0)?H`<span class="low-carbon">${this.displayNonFossilState(null===(ri=Ro.fossil_fuel_percentage)||void 0===ri?void 0:ri.entity)}</span>`:""}</div>${this.showLine(Gn||0)?H`<svg width="80" height="30"><path d="M40 -10 v40" class="low-carbon" id="low-carbon"/>${Bn?U`<circle r="2.4" class="low-carbon" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(li=Ro.fossil_fuel_percentage)||void 0===li?void 0:li.calculate_flow_rate,Xn.nonFossil)||0}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#low-carbon"></animateMotion></circle>`:""}</svg>`:""}</div>`:H`<div class="spacer"></div>`} ${Zo?H`<div class="circle-container solar"><span class="label">${sr}</span><div class="circle" @click="${t=>{t.stopPropagation(),this.openDetails(Ro.solar.entity)}}" @keyDown="${t=>{"Enter"===t.key&&(t.stopPropagation(),this.openDetails(Ro.solar.entity))}}">${Go?H`<span class="secondary-info solar" @click="${t=>{var e,i;t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.solar)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity)}}" @keyDown="${t=>{var e,i;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.solar)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity))}}">${(null===(si=null===(ai=Ro.solar)||void 0===ai?void 0:ai.secondary_info)||void 0===si?void 0:si.icon)?H`<ha-icon class="secondary-info small" .icon="${null===(ci=null===(di=Ro.solar)||void 0===di?void 0:di.secondary_info)||void 0===ci?void 0:ci.icon}"></ha-icon>`:""} ${this.displayValue(bn,null===(vi=null===(ui=Ro.solar)||void 0===ui?void 0:ui.secondary_info)||void 0===vi?void 0:vi.unit_of_measurement,null===(pi=null===(hi=Ro.solar)||void 0===hi?void 0:hi.secondary_info)||void 0===pi?void 0:pi.unit_white_space)}</span>`:""}<ha-icon id="solar-icon" .icon="${ar}" style="${Go?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(yi=Ro.solar)||void 0===yi?void 0:yi.display_zero_state)||(wn||0)>0?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(gi=Ro.solar)||void 0===gi?void 0:gi.display_zero_state)||(wn||0)>0?H`<span class="solar">${this.displayValue(wn)}</span>`:""}</div></div>`:Fo||Vo?H`<div class="spacer"></div>`:""} ${Fo?H`<div class="circle-container individual2"><span class="label">${mn}</span><div class="circle" @click="${t=>{var e;t.stopPropagation(),this.openDetails(null===(e=Ro.individual2)||void 0===e?void 0:e.entity)}}" @keyDown="${t=>{var e;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(e=Ro.individual2)||void 0===e?void 0:e.entity))}}">${Lo?H`<span class="secondary-info individual2" @click="${t=>{var e,i;t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.individual2)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity)}}" @keyDown="${t=>{var e,i;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.individual2)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity))}}">${(null===(_i=null===(mi=Ro.individual2)||void 0===mi?void 0:mi.secondary_info)||void 0===_i?void 0:_i.icon)?H`<ha-icon class="secondary-info small" .icon="${null===(bi=null===(fi=Ro.individual2)||void 0===fi?void 0:fi.secondary_info)||void 0===bi?void 0:bi.icon}"></ha-icon>`:""} ${this.displayValue(gn,null===(wi=null===($i=Ro.individual2)||void 0===$i?void 0:$i.secondary_info)||void 0===wi?void 0:wi.unit_of_measurement,null===(ki=null===(xi=Ro.individual2)||void 0===xi?void 0:xi.secondary_info)||void 0===ki?void 0:ki.unit_white_space)}</span>`:""}<ha-icon id="individual2-icon" .icon="${_n}" style="${Lo?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Ei=Ro.individual2)||void 0===Ei?void 0:Ei.display_zero_state)||(yn||0)>0?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Si=Ro.individual2)||void 0===Si?void 0:Si.display_zero_state)||(yn||0)>0?H`<span class="individual2">${pr}</span>`:""}</div>${this.showLine(yn||0)?H`<svg width="80" height="30"><path d="M40 -10 v50" id="individual2"/>${yn?U`<circle r="2.4" class="individual2" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Ai=Ro.individual2)||void 0===Ai?void 0:Ai.calculate_flow_rate,Xn.individual2)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${(null===(Mi=Ro.individual2)||void 0===Mi?void 0:Mi.inverted_animation)?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual2"></animateMotion></circle>`:""}</svg>`:""}</div>`:Vo?H`<div class="circle-container individual1"><span class="label">${vn}</span><div class="circle" @click="${t=>{var e;t.stopPropagation(),this.openDetails(null===(e=Ro.individual1)||void 0===e?void 0:e.entity)}}" @keyDown="${t=>{var e;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(e=Ro.individual1)||void 0===e?void 0:e.entity))}}">${Bo?H`<span class="secondary-info individual1" @click="${t=>{var e,i;t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.individual1)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity)}}" @keyDown="${t=>{var e,i;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.individual1)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity))}}">${(null===(Pi=null===(Ci=Ro.individual1)||void 0===Ci?void 0:Ci.secondary_info)||void 0===Pi?void 0:Pi.icon)?H`<ha-icon class="secondary-info small" .icon="${null===(Oi=null===(Di=Ro.individual1)||void 0===Di?void 0:Di.secondary_info)||void 0===Oi?void 0:Oi.icon}"></ha-icon>`:""} ${this.displayValue(un,null===(Ni=null===(ji=Ro.individual1)||void 0===ji?void 0:ji.secondary_info)||void 0===Ni?void 0:Ni.unit_of_measurement,null===(Ti=null===(zi=Ro.individual1)||void 0===zi?void 0:zi.secondary_info)||void 0===Ti?void 0:Ti.unit_white_space)}</span>`:""}<ha-icon id="individual1-icon" .icon="${hn}" style="${Bo?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Ri=Ro.individual1)||void 0===Ri?void 0:Ri.display_zero_state)||(cn||0)>0?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Hi=Ro.individual1)||void 0===Hi?void 0:Hi.display_zero_state)||(cn||0)>0?H`<span class="individual1">${hr}</span>`:""}</div>${this.showLine(cn||0)?H`<svg width="80" height="30"><path d="M40 -10 v40" id="individual1"/>${cn?U`<circle r="2.4" class="individual1" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Ui=Ro.individual1)||void 0===Ui?void 0:Ui.calculate_flow_rate,Xn.individual1)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${(null===(Ii=Ro.individual1)||void 0===Ii?void 0:Ii.inverted_animation)?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual1"></animateMotion></circle>`:""}</svg>`:H``}</div>`:H`<div class="spacer"></div>`}</div>`:H``}<div class="row">${Uo?H`<div class="circle-container grid"><div class="circle" @click="${t=>{const e="string"==typeof Ro.grid.entity?Ro.grid.entity:Ro.grid.entity.consumption||Ro.grid.entity.production;t.stopPropagation(),this.openDetails(e)}}" @keyDown="${t=>{if("Enter"===t.key){const e="string"==typeof Ro.grid.entity?Ro.grid.entity:Ro.grid.entity.consumption||Ro.grid.entity.production;t.stopPropagation(),this.openDetails(e)}}}">${Xo?H`<span class="secondary-info grid" @click="${t=>{var e,i;t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.grid)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity)}}" @keyDown="${t=>{var e,i;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.grid)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity))}}">${(null===(Fi=null===(Wi=Ro.grid)||void 0===Wi?void 0:Wi.secondary_info)||void 0===Fi?void 0:Fi.icon)?H`<ha-icon class="secondary-info small" .icon="${null===(Vi=null===(Li=Ro.grid)||void 0===Li?void 0:Li.secondary_info)||void 0===Vi?void 0:Vi.icon}"></ha-icon>`:""} ${this.displayValue(tn,null===(Zi=null===(Bi=Ro.grid)||void 0===Bi?void 0:Bi.secondary_info)||void 0===Zi?void 0:Zi.unit_of_measurement,null===(Yi=null===(Gi=Ro.grid)||void 0===Gi?void 0:Gi.secondary_info)||void 0===Yi?void 0:Yi.unit_white_space)}</span>`:""}<ha-icon .icon="${nn}"></ha-icon>${("two_way"===(null===(Ki=Ro.grid)||void 0===Ki?void 0:Ki.display_state)||void 0===(null===(qi=Ro.grid)||void 0===qi?void 0:qi.display_state)||"one_way"===(null===(Ji=Ro.grid)||void 0===Ji?void 0:Ji.display_state)&&Jo>0||"one_way_no_zero"===(null===(Qi=Ro.grid)||void 0===Qi?void 0:Qi.display_state)&&(null===qo||0===qo)&&0!==Jo)&&null!==Jo&&!Io?H`<span class="return" @click="${t=>{const e="string"==typeof Ro.grid.entity?Ro.grid.entity:Ro.grid.entity.production;t.stopPropagation(),this.openDetails(e)}}" @keyDown="${t=>{if("Enter"===t.key){const e="string"==typeof Ro.grid.entity?Ro.grid.entity:Ro.grid.entity.production;t.stopPropagation(),this.openDetails(e)}}}"><ha-icon class="small" .icon="${"mdi:arrow-left"}"></ha-icon>${this.displayValue(Jo)}</span>`:null} ${("two_way"===(null===(Xi=Ro.grid)||void 0===Xi?void 0:Xi.display_state)||void 0===(null===(to=Ro.grid)||void 0===to?void 0:to.display_state)||"one_way"===(null===(eo=Ro.grid)||void 0===eo?void 0:eo.display_state)&&qo>0||"one_way_no_zero"===(null===(io=Ro.grid)||void 0===io?void 0:io.display_state)&&(null===Jo||0===Jo))&&null!==qo&&!Io?H`<span class="consumption"><ha-icon class="small" .icon="${"mdi:arrow-right"}"></ha-icon>${this.displayValue(qo)}</span>`:""} ${Io?H`<span class="grid power-outage">${(null===(oo=Ro.grid)||void 0===oo?void 0:oo.power_outage.label_alert)||H`Power<br>Outage`}</span>`:""}</div><span class="label">${rn}</span></div>`:H`<div class="spacer"></div>`}<div class="circle-container home"><div class="circle" id="home-circle" @click="${t=>{var e;t.stopPropagation(),this.openDetails(null===(e=Ro.home)||void 0===e?void 0:e.entity)}}" @keyDown="${t=>{var e;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(e=Ro.home)||void 0===e?void 0:e.entity))}}">${Yo?H`<span class="secondary-info home" @click="${t=>{var e,i;t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.home)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity)}}" @keyDown="${t=>{var e,i;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.home)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity))}}">${(null===(ro=null===(no=Ro.home)||void 0===no?void 0:no.secondary_info)||void 0===ro?void 0:ro.icon)?H`<ha-icon class="secondary-info small" .icon="${null===(ao=null===(lo=Ro.home)||void 0===lo?void 0:lo.secondary_info)||void 0===ao?void 0:ao.icon}"></ha-icon>`:""} ${this.displayValue($n,null===(co=null===(so=Ro.home)||void 0===so?void 0:so.secondary_info)||void 0===co?void 0:co.unit_of_measurement,null===(vo=null===(uo=Ro.home)||void 0===uo?void 0:uo.secondary_info)||void 0===vo?void 0:vo.unit_white_space)}</span>`:""}<ha-icon .icon="${dr}"></ha-icon>${yr} <svg>${void 0!==Fn?U`<circle class="solar" cx="40" cy="40" r="38" stroke-dasharray="${Fn} ${Jt-Fn}" shape-rendering="geometricPrecision" stroke-dashoffset="-${Jt-Fn}">`:""} ${Wn?U`<circle class="battery" cx="40" cy="40" r="38" stroke-dasharray="${Wn} ${Jt-Wn}" stroke-dashoffset="-${Jt-Wn-(Fn||0)}" shape-rendering="geometricPrecision">`:""} ${void 0!==Yn?U`<circle class="low-carbon" cx="40" cy="40" r="38" stroke-dasharray="${Yn} ${Jt-Yn}" stroke-dashoffset="-${Jt-Yn-(Wn||0)-(Fn||0)}" shape-rendering="geometricPrecision">`:""}<circle class="grid" cx="40" cy="40" r="38" stroke-dasharray="${null!=Kn?Kn:Jt-Fn-(Wn||0)} ${void 0!==Kn?Jt-Kn:Fn+(Wn||0)}" stroke-dashoffset="0" shape-rendering="geometricPrecision"/></svg></div>${this.showLine(cn||0)&&Fo?"":H`<span class="label">${cr}</span>`}</div></div>${Wo||Vo&&Fo?H`<div class="row"><div class="spacer"></div>${Wo?H`<div class="circle-container battery"><div class="circle" @click="${t=>{var e,i,o,n,r;const l=(null===(e=Ro.battery)||void 0===e?void 0:e.state_of_charge)?null===(i=Ro.battery)||void 0===i?void 0:i.state_of_charge:"string"==typeof(null===(o=Ro.battery)||void 0===o?void 0:o.entity)?null===(n=Ro.battery)||void 0===n?void 0:n.entity:null===(r=Ro.battery)||void 0===r?void 0:r.entity.production;t.stopPropagation(),this.openDetails(l)}}" @keyDown="${t=>{var e,i;if("Enter"===t.key){const o=(null===(e=Ro.battery)||void 0===e?void 0:e.state_of_charge)?null===(i=Ro.battery)||void 0===i?void 0:i.state_of_charge:"string"==typeof Ro.battery.entity?Ro.battery.entity:Ro.battery.entity.production;t.stopPropagation(),this.openDetails(o)}}}">${null!==Jn?H`<span @click="${t=>{var e;t.stopPropagation(),this.openDetails(null===(e=Ro.battery)||void 0===e?void 0:e.state_of_charge)}}" @keyDown="${t=>{var e;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(e=Ro.battery)||void 0===e?void 0:e.state_of_charge))}}" id="battery-state-of-charge-text">${ft(Jn,this.hass.locale,{maximumFractionDigits:0,minimumFractionDigits:0})}${!1===(null===(po=null===(ho=this._config.entities)||void 0===ho?void 0:ho.battery)||void 0===po?void 0:po.state_of_charge_unit_white_space)?"":" "}%</span>`:null}<ha-icon .icon="${Qn}" style="${"two_way"===(null===(yo=Ro.battery)||void 0===yo?void 0:yo.display_state)?"padding-top: 0px; padding-bottom: 2px;":"one_way"===(null===(go=Ro.battery)||void 0===go?void 0:go.display_state)&&0===xn&&0===kn?"padding-top: 2px; padding-bottom: 0px;":"padding-top: 2px; padding-bottom: 2px;"}" @click="${t=>{var e;t.stopPropagation(),this.openDetails(null===(e=Ro.battery)||void 0===e?void 0:e.state_of_charge)}}" @keyDown="${t=>{var e;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(e=Ro.battery)||void 0===e?void 0:e.state_of_charge))}}"></ha-icon>${"two_way"===(null===(mo=Ro.battery)||void 0===mo?void 0:mo.display_state)||void 0===(null===(_o=Ro.battery)||void 0===_o?void 0:_o.display_state)||"one_way"===(null===(fo=Ro.battery)||void 0===fo?void 0:fo.display_state)&&xn>0||"one_way_no_zero"===(null===(bo=Ro.battery)||void 0===bo?void 0:bo.display_state)&&0!==xn?H`<span class="battery-in" @click="${t=>{const e="string"==typeof Ro.battery.entity?Ro.battery.entity:Ro.battery.entity.production;t.stopPropagation(),this.openDetails(e)}}" @keyDown="${t=>{if("Enter"===t.key){const e="string"==typeof Ro.battery.entity?Ro.battery.entity:Ro.battery.entity.production;t.stopPropagation(),this.openDetails(e)}}}"><ha-icon class="small" .icon="${"mdi:arrow-down"}"></ha-icon>${this.displayValue(xn)}</span>`:""} ${"two_way"===(null===($o=Ro.battery)||void 0===$o?void 0:$o.display_state)||void 0===(null===(wo=Ro.battery)||void 0===wo?void 0:wo.display_state)||"one_way"===(null===(xo=Ro.battery)||void 0===xo?void 0:xo.display_state)&&kn>0||"one_way_no_zero"===(null===(ko=Ro.battery)||void 0===ko?void 0:ko.display_state)&&(0===xn||0!==kn)?H`<span class="battery-out" @click="${t=>{const e="string"==typeof Ro.battery.entity?Ro.battery.entity:Ro.battery.entity.consumption;t.stopPropagation(),this.openDetails(e)}}" @keyDown="${t=>{if("Enter"===t.key){const e="string"==typeof Ro.battery.entity?Ro.battery.entity:Ro.battery.entity.consumption;t.stopPropagation(),this.openDetails(e)}}}"><ha-icon class="small" .icon="${"mdi:arrow-up"}"></ha-icon>${this.displayValue(kn)}</span>`:""}</div><span class="label">${Nn}</span></div>`:H`<div class="spacer"></div>`} ${Fo&&Vo?H`<div class="circle-container individual1 bottom">${this.showLine(cn||0)?H`<svg width="80" height="30"><path d="M40 40 v-40" id="individual1"/>${cn?U`<circle r="2.4" class="individual1" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Eo=Ro.individual1)||void 0===Eo?void 0:Eo.calculate_flow_rate,Xn.individual1)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${(null===(So=Ro.individual1)||void 0===So?void 0:So.inverted_animation)?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual1"></animateMotion></circle>`:""}</svg>`:H`<svg width="80" height="30"></svg>`}<div class="circle" @click="${t=>{var e;t.stopPropagation(),this.openDetails(null===(e=Ro.individual1)||void 0===e?void 0:e.entity)}}" @keyDown="${t=>{var e;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(e=Ro.individual1)||void 0===e?void 0:e.entity))}}">${Bo?H`<span class="secondary-info individual1" @click="${t=>{var e,i;t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.individual1)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity)}}" @keyDown="${t=>{var e,i;"Enter"===t.key&&(t.stopPropagation(),this.openDetails(null===(i=null===(e=Ro.individual1)||void 0===e?void 0:e.secondary_info)||void 0===i?void 0:i.entity))}}">${(null===(Mo=null===(Ao=Ro.individual1)||void 0===Ao?void 0:Ao.secondary_info)||void 0===Mo?void 0:Mo.icon)?H`<ha-icon class="secondary-info small" .icon="${null===(Po=null===(Co=Ro.individual1)||void 0===Co?void 0:Co.secondary_info)||void 0===Po?void 0:Po.icon}"></ha-icon>`:""} ${this.displayValue(un,null===(Oo=null===(Do=Ro.individual1)||void 0===Do?void 0:Do.secondary_info)||void 0===Oo?void 0:Oo.unit_of_measurement,null===(No=null===(jo=Ro.individual1)||void 0===jo?void 0:jo.secondary_info)||void 0===No?void 0:No.unit_white_space)}</span>`:""}<ha-icon id="individual1-icon" .icon="${hn}" style="${Bo?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(zo=Ro.individual1)||void 0===zo?void 0:zo.display_zero_state)||(cn||0)>0?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(To=Ro.individual1)||void 0===To?void 0:To.display_zero_state)||(cn||0)>0?H`<span class="individual1">${hr}</span>`:""}</div><span class="label">${vn}</span></div>`:H`<div class="spacer"></div>`}</div>`:H`<div class="spacer"></div>`} ${Zo&&this.showLine(En||0)?H`<div class="lines ${It({high:Wo,"individual1-individual2":!Wo&&Fo&&Vo})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-home-flow"><path id="solar" class="solar" d="M${Wo?55:53},0 v${Uo?15:17} c0,${Wo?"30 10,30 30,30":"35 10,35 30,35"} h25" vector-effect="non-scaling-stroke"></path>${En?U`<circle r="1" class="solar" vector-effect="non-scaling-stroke"><animateMotion dur="${Xn.solarToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#solar"></animateMotion></circle>`:""}</svg></div>`:""} ${Ko&&Zo&&this.showLine(Cn)?H`<div class="lines ${It({high:Wo,"individual1-individual2":!Wo&&Fo&&Vo})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-grid-flow"><path id="return" class="return" d="M${Wo?45:47},0 v15 c0,${Wo?"30 -10,30 -30,30":"35 -10,35 -30,35"} h-20" vector-effect="non-scaling-stroke"></path>${Cn&&Zo?U`<circle r="1" class="return" vector-effect="non-scaling-stroke"><animateMotion dur="${Xn.solarToGrid}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#return"></animateMotion></circle>`:""}</svg></div>`:""} ${Wo&&Zo&&this.showLine(Mn||0)?H`<div class="lines ${It({high:Wo,"individual1-individual2":!Wo&&Fo&&Vo})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-battery-flow" class="flat-line"><path id="battery-solar" class="battery-solar" d="M50,0 V100" vector-effect="non-scaling-stroke"></path>${Mn?U`<circle r="1" class="battery-solar" vector-effect="non-scaling-stroke"><animateMotion dur="${Xn.solarToBattery}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-solar"></animateMotion></circle>`:""}</svg></div>`:""} ${Uo&&this.showLine(Hn)?H`<div class="lines ${It({high:Wo,"individual1-individual2":!Wo&&Fo&&Vo})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="grid-home-flow" class="flat-line"><path class="grid" id="grid" d="M0,${Wo?50:Zo?56:53} H100" vector-effect="non-scaling-stroke"></path>${Hn?U`<circle r="1" class="grid" vector-effect="non-scaling-stroke"><animateMotion dur="${Xn.gridToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#grid"></animateMotion></circle>`:""}</svg></div>`:null} ${Wo&&this.showLine(Pn)?H`<div class="lines ${It({high:Wo,"individual1-individual2":!Wo&&Fo&&Vo})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="battery-home-flow"><path id="battery-home" class="battery-home" d="M55,100 v-${Uo?15:17} c0,-30 10,-30 30,-30 h20" vector-effect="non-scaling-stroke"></path>${Pn?U`<circle r="1" class="battery-home" vector-effect="non-scaling-stroke"><animateMotion dur="${Xn.batteryToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-home"></animateMotion></circle>`:""}</svg></div>`:""} ${Uo&&Wo&&this.showLine(Math.max(Sn||0,An||0))?H`<div class="lines ${It({high:Wo,"individual1-individual2":!Wo&&Fo&&Vo})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="battery-grid-flow"><path id="battery-grid" class="${It({"battery-from-grid":Boolean(Sn),"battery-to-grid":Boolean(An)})}" d="M45,100 v-15 c0,-30 -10,-30 -30,-30 h-20" vector-effect="non-scaling-stroke"></path>${Sn?U`<circle r="1" class="battery-from-grid" vector-effect="non-scaling-stroke"><animateMotion dur="${Xn.batteryGrid}s" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#battery-grid"></animateMotion></circle>`:""} ${An?U`<circle r="1" class="battery-to-grid" vector-effect="non-scaling-stroke"><animateMotion dur="${Xn.batteryGrid}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-grid"></animateMotion></circle>`:""}</svg></div>`:""}</div>${this._config.dashboard_link?H`<div class="card-actions"><a href="${this._config.dashboard_link}"><mwc-button>${this._config.dashboard_link_label||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.go_to_energy_dashboard")}</mwc-button></a></div>`:""}</ha-card>`}updated(t){super.updated(t),this._config&&this.hass}};Qt.styles=Lt,t([st({attribute:!1})],Qt.prototype,"hass",void 0),t([dt()],Qt.prototype,"_config",void 0),t([dt()],Qt.prototype,"states",void 0),t([dt()],Qt.prototype,"entitiesArr",void 0),t([dt()],Qt.prototype,"error",void 0),Qt=t([lt("energy-flow-card-plus")],Qt);var Xt=Qt;class te extends TypeError{constructor(t,e){let i;const{message:o,...n}=t,{path:r}=t;super(0===r.length?o:"At path: "+r.join(".")+" -- "+o),this.value=void 0,this.key=void 0,this.type=void 0,this.refinement=void 0,this.path=void 0,this.branch=void 0,this.failures=void 0,Object.assign(this,n),this.name=this.constructor.name,this.failures=()=>{var o;return null!=(o=i)?o:i=[t,...e()]}}}function ee(t){return"object"==typeof t&&null!=t}function ie(t){return"string"==typeof t?JSON.stringify(t):""+t}function oe(t,e,i,o){if(!0===t)return;!1===t?t={}:"string"==typeof t&&(t={message:t});const{path:n,branch:r}=e,{type:l}=i,{refinement:a,message:s="Expected a value of type `"+l+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+ie(o)+"`"}=t;return{value:o,type:l,refinement:a,key:n[n.length-1],path:n,branch:r,...t,message:s}}function*ne(t,e,i,o){(function(t){return ee(t)&&"function"==typeof t[Symbol.iterator]})(t)||(t=[t]);for(const n of t){const t=oe(n,e,i,o);t&&(yield t)}}function*re(t,e,i){void 0===i&&(i={});const{path:o=[],branch:n=[t],coerce:r=!1,mask:l=!1}=i,a={path:o,branch:n};if(r&&(t=e.coercer(t,a),l&&"type"!==e.type&&ee(e.schema)&&ee(t)&&!Array.isArray(t)))for(const i in t)void 0===e.schema[i]&&delete t[i];let s=!0;for(const i of e.validator(t,a))s=!1,yield[i,void 0];for(let[i,d,c]of e.entries(t,a)){const e=re(d,c,{path:void 0===i?o:[...o,i],branch:void 0===i?n:[...n,d],coerce:r,mask:l});for(const o of e)o[0]?(s=!1,yield[o[0],void 0]):r&&(d=o[1],void 0===i?t=d:t instanceof Map?t.set(i,d):t instanceof Set?t.add(d):ee(t)&&(t[i]=d))}if(s)for(const i of e.refiner(t,a))s=!1,yield[i,void 0];s&&(yield[void 0,t])}class le{constructor(t){this.TYPE=void 0,this.type=void 0,this.schema=void 0,this.coercer=void 0,this.validator=void 0,this.refiner=void 0,this.entries=void 0;const{type:e,schema:i,validator:o,refiner:n,coercer:r=(t=>t),entries:l=function*(){}}=t;this.type=e,this.schema=i,this.entries=l,this.coercer=r,this.validator=o?(t,e)=>ne(o(t,e),e,this,t):()=>[],this.refiner=n?(t,e)=>ne(n(t,e),e,this,t):()=>[]}assert(t){return ae(t,this)}create(t){return function(t,e){const i=se(t,e,{coerce:!0});if(i[0])throw i[0];return i[1]}(t,this)}is(t){return function(t,e){const i=se(t,e);return!i[0]}(t,this)}mask(t){return function(t,e){const i=se(t,e,{coerce:!0,mask:!0});if(i[0])throw i[0];return i[1]}(t,this)}validate(t,e){return void 0===e&&(e={}),se(t,this,e)}}function ae(t,e){const i=se(t,e);if(i[0])throw i[0]}function se(t,e,i){void 0===i&&(i={});const o=re(t,e,i),n=function(t){const{done:e,value:i}=t.next();return e?void 0:i}(o);if(n[0]){const t=new te(n[0],(function*(){for(const t of o)t[0]&&(yield t[0])}));return[t,void 0]}return[void 0,n[1]]}function de(t,e){return new le({type:t,schema:null,validator:e})}function ce(){return de("any",(()=>!0))}function ue(){return de("boolean",(t=>"boolean"==typeof t))}function ve(){return de("integer",(t=>"number"==typeof t&&!isNaN(t)&&Number.isInteger(t)||"Expected an integer, but received: "+ie(t)))}function he(){return de("number",(t=>"number"==typeof t&&!isNaN(t)||"Expected a number, but received: "+ie(t)))}function pe(t){const e=t?Object.keys(t):[],i=de("never",(()=>!1));return new le({type:"object",schema:t||null,*entries(o){if(t&&ee(o)){const n=new Set(Object.keys(o));for(const i of e)n.delete(i),yield[i,o[i],t[i]];for(const t of n)yield[t,o[t],i]}},validator:t=>ee(t)||"Expected an object, but received: "+ie(t),coercer:t=>ee(t)?{...t}:t})}function ye(t){return new le({...t,validator:(e,i)=>void 0===e||t.validator(e,i),refiner:(e,i)=>void 0===e||t.refiner(e,i)})}function ge(){return de("string",(t=>"string"==typeof t||"Expected a string, but received: "+ie(t)))}function me(t){return{type:"expandable",title:`Separated ${t||"Grid"} Entities (One for production, one for consumption)`,name:"entity",schema:[{name:"consumption",label:"Consumption Entity",selector:{entity:{}}},{name:"production",label:"Production Entity",selector:{entity:{}}}]}}const _e={name:"color",title:"Custom Colors",type:"expandable",schema:[{type:"grid",column_min_width:"200px",schema:[{name:"consumption",label:"Consumption",selector:{color_rgb:{}}},{name:"production",label:"Production",selector:{color_rgb:{}}}]}]},fe=[{name:"entity",selector:{entity:{}}},{name:"template",label:"Template (overrides entity, save to update)",selector:{template:{}}},{type:"grid",column_min_width:"200px",schema:[{name:"icon",selector:{icon:{}}},{name:"unit_of_measurement",label:"Unit of Measurement",selector:{text:{}}},{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}}]}],be=[{name:"color_icon",label:"Color of Icon",selector:{select:{options:[{value:!1,label:"Do not Color"},{value:!0,label:"Color dynamically"},{value:"production",label:"Production"},{value:"consumption",label:"Consumption"}],custom_value:!0}}},{name:"color_circle",label:"Color of Circle",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Consumption"},{value:"production",label:"Production"}],custom_value:!0}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{min:0,max:1e6,step:1,mode:"box"}}},{name:"display_state",label:"Display State",selector:{select:{options:[{value:"two_way",label:"Two Way"},{value:"one_way",label:"One Way"},{value:"one_way_no_zero",label:"One Way (Show Zero)"}],custom_value:!0}}}];function $e(t){const e={type:"grid",column_min_width:"200px",schema:[{name:"name",selector:{text:{}}},{name:"icon",selector:{icon:{}}}]};return"battery"!==t&&"grid"!==t||e.schema.push(...be),e}const we=[me(),$e("grid"),_e,{title:"Secondary Info",name:"secondary_info",type:"expandable",schema:fe},{title:"Power Outage",name:"power_outage",type:"expandable",schema:[{name:"entity",selector:{entity:{}}},{type:"grid",column_min_width:"200px",schema:[{name:"label_alert",label:"Outage Label",selector:{text:{}}},{name:"icon_alert",label:"Outage Icon",selector:{icon:{}}},{name:"state_alert",label:"Outage State",selector:{text:{}}}]}]}],xe=Object.assign(Object.assign({},$e("battery")),{schema:[...$e("battery").schema,{name:"color_state_of_charge_value",label:"Color State of Charge Value",selector:{select:{options:[{value:!1,label:"Do Not Color"},{value:!0,label:"Color dynamically"},{value:"consumption",label:"Consumption"},{value:"production",label:"Production"}],custom_value:!0}}}]}),ke=[me("battery"),{name:"state_of_charge",label:"State of Charge Entity",selector:{entity:{}}},xe,_e],Ee=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},$e()),{schema:[...$e().schema,{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero_state",label:"Display State When Zero?",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:"Secondary Info",name:"secondary_info",type:"expandable",schema:fe}],Se=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},$e()),{schema:[...$e().schema,{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"unit_of_measurement",label:"Unit of Measurement",selector:{text:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"inverted_animation",label:"Invert Animation",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"display_zero_state",label:"Display Zero State",selector:{boolean:{}}},{name:"decimals",label:"Decimals",selector:{number:{mode:"box",min:0,max:4,step:1}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:"Secondary Info",name:"secondary_info",type:"expandable",schema:fe}],Ae=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},$e()),{schema:[...$e().schema,{name:"state_type",label:"State Type",selector:{select:{options:[{value:"power",label:"Power"},{value:"percentage",label:"Percentage"}],custom_value:!0}}},{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"display_zero_state",label:"Display Zero State",selector:{boolean:{}}},{name:"unit_white_space",label:"Unit White Space",selector:{boolean:{}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:"Secondary Info",name:"secondary_info",type:"expandable",schema:fe}],Me=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},$e()),{schema:[...$e().schema,{name:"color_value",label:"Color Value",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Do Not Color"},{value:"solar",label:"Solar"},{value:"grid",label:"Grid"},{value:"battery",label:"Battery"}],custom_value:!0}}},{name:"color_icon",label:"Color Icon",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Do Not Color"},{value:"solar",label:"Solar"},{value:"grid",label:"Grid"},{value:"battery",label:"Battery"}],custom_value:!0}}},{name:"subtract_individual",label:"Subtract Individual",selector:{boolean:{}}},{name:"override_state",label:"Override State (With Home Entity)",selector:{boolean:{}}}]}),{title:"Secondary Info",name:"secondary_info",type:"expandable",schema:fe}],Ce=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];const o="type"===e[0].type,n=e.map((t=>t.schema)),r=Object.assign({},...n);return o?function(t){const e=Object.keys(t);return new le({type:"type",schema:t,*entries(i){if(ee(i))for(const o of e)yield[o,i[o],t[o]]},validator:t=>ee(t)||"Expected an object, but received: "+ie(t)})}(r):pe(r)}(pe({type:ge(),view_layout:ce()}),pe({title:ye(ge()),theme:ye(ge()),dashboard_link:ye(ge()),dashboard_link_label:ye(ge()),inverted_entities:ye(ce()),wh_decimals:ye(ve()),kwh_decimals:ye(ve()),min_flow_rate:ye(he()),max_flow_rate:ye(he()),min_expected_energy:ye(he()),max_expected_energy:ye(he()),wh_kwh_threshold:ye(he()),clickable_entities:ye(ue()),display_zero_lines:ye(ue()),use_new_flow_rate_model:ye(ue()),energy_date_selection:ye(ue()),entities:pe({battery:ye(ce()),grid:ye(ce()),solar:ye(ce()),home:ye(ce()),fossil_fuel_percentage:ye(ce()),individual1:ye(ce()),individual2:ye(ce())})})),Pe=[{name:"title",label:"Title",selector:{text:{}}}],De=[{name:"entities",type:"grid",column_min_width:"400px",schema:[{title:"Grid",name:"grid",type:"expandable",schema:we},{title:"Solar",name:"solar",type:"expandable",schema:Ee},{title:"Battery",name:"battery",type:"expandable",schema:ke},{title:"Non-Fossil",name:"fossil_fuel_percentage",type:"expandable",schema:Ae},{title:"Home",name:"home",type:"expandable",schema:Me},{title:"Individual 1",name:"individual1",type:"expandable",schema:Se},{title:"Individual 2",name:"individual2",type:"expandable",schema:Se}]}],Oe=[{title:"Advanced Options",type:"expandable",schema:[{type:"grid",column_min_width:"200px",schema:[{name:"dashboard_link",label:"Dashboard Link",selector:{navigation:{}}},{name:"dashboard_link_label",label:"Dashboard Link Label",selector:{text:{}}},{name:"wh_decimals",label:"Watt Decimals",selector:{number:{mode:"box",min:0,max:5,step:1}}},{name:"kwh_decimals",label:"kW Decimals",selector:{number:{mode:"box",min:0,max:5,step:1}}},{name:"max_flow_rate",label:"Max Flow Rate (Sec/Dot)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"min_flow_rate",label:"Min Flow Rate (Sec/Dot)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"max_expected_energy",label:"Max Expected Power (in Watts)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"min_expected_energy",label:"Min Expected Power (in Watts)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"wh_kwh_threshold",label:"Watt to Kilowatt Threshold",selector:{number:{mode:"box",min:0,max:1e6,step:1}}},{name:"display_zero_lines",label:"Display Zero Lines",selector:{boolean:{}}},{name:"clickable_entities",label:"Clickable Entities",selector:{boolean:{}}},{name:"use_new_flow_rate_model",label:"New Flow Model?",selector:{boolean:{}}}]},{name:"inverted_entities",label:"Inverted Entities",selector:{template:{}}}]}],je=async()=>{var t,e;if(customElements.get("ha-form"))return;const i=await(null===(e=(t=window).loadCardHelpers)||void 0===e?void 0:e.call(t));if(!i)return;const o=await i.createCardElement({type:"entity"});o&&await o.getConfigElement()};let Ne=class extends nt{constructor(){super(...arguments),this._computeLabelCallback=t=>(null==t?void 0:t.label)||this.hass.localize(`ui.panel.lovelace.editor.card.generic.${null==t?void 0:t.name}`||(null==t?void 0:t.name)||"")}async setConfig(t){ae(t,Ce),this._config=t}connectedCallback(){super.connectedCallback(),je()}render(){if(!this.hass||!this._config)return W;const t=Object.assign({},this._config);return H`<div class="card-config"><ha-form .hass="${this.hass}" .data="${t}" .schema="${Pe}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}"></ha-form><div style="height:24px"></div><ha-form .hass="${this.hass}" .data="${t}" .schema="${De}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}" class="entities-section"></ha-form><div style="height:24px"></div><ha-form .hass="${this.hass}" .data="${t}" .schema="${Oe}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}"></ha-form></div>`}_valueChanged(t){const e=t.detail.value||"";this._config&&this.hass&&function(t,e,i,o){o=o||{},i=null==i?{}:i;var n=new Event(e,{bubbles:void 0===o.bubbles||o.bubbles,cancelable:Boolean(o.cancelable),composed:void 0===o.composed||o.composed});n.detail=i,t.dispatchEvent(n)}(this,"config-changed",{config:e})}static get styles(){return l`ha-form{width:100%}ha-icon-button{align-self:center}.entities-section *{background-color:red}.card-config{display:flex;flex-direction:column;justify-content:space-between;align-items:center;margin-bottom:10px}.config-header{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.config-header.sub-header{margin-top:24px}ha-icon{padding-bottom:2px;position:relative;top:-4px;right:1px}`}};t([st({attribute:!1})],Ne.prototype,"hass",void 0),t([dt()],Ne.prototype,"_config",void 0),Ne=t([lt("energy-flow-card-plus-editor")],Ne);var ze=Object.freeze({__proto__:null,loadHaForm:je,get EnergyFlowCardPlusEditor(){return Ne}});export{Xt as default};
